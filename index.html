<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Centro de Control - Retorna</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #0a0e1a; color: #e2e8f0; min-height: 100vh; }
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: #1a1f35; }
  ::-webkit-scrollbar-thumb { background: #3b4472; border-radius: 3px; }
  @keyframes pulseRed { 0%,100%{opacity:1} 50%{opacity:.5} }
  @keyframes pulseDot { 0%,100%{transform:scale(1)} 50%{transform:scale(1.4)} }
  @keyframes fadeIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)} }
  .pulse-red { animation: pulseRed 2s infinite; }
  .pulse-dot { animation: pulseDot 1.5s infinite; }
  .fade-in { animation: fadeIn .35s ease-out; }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useCallback} = React;

/* ‚îÄ‚îÄ palette ‚îÄ‚îÄ */
const C = {
  green:'#10b981', yellow:'#f59e0b', orange:'#f97316', red:'#ef4444',
  blue:'#3b82f6', purple:'#8b5cf6',
  bg:'#0a0e1a', card:'#111827', border:'#1f2937',
  t1:'#f1f5f9', t2:'#94a3b8', t3:'#64748b',
};

/* ========== SIMPLE SVG BAR CHART ========== */
const SimpleBarChart = ({data, bars, height=200, xKey}) => {
  const maxVal = Math.max(...data.flatMap(d => bars.map(b => d[b.key]||0)));
  const barW = Math.floor(100 / data.length / bars.length);
  return (
    <svg width="100%" height={height} viewBox={`0 0 ${data.length*60} ${height}`} style={{overflow:'visible'}}>
      {data.map((d,i) => bars.map((b,bi) => {
        const h = maxVal ? (d[b.key]/maxVal)*(height-30) : 0;
        const x = i*60 + bi*(barW+2) + 8;
        return <g key={`${i}-${bi}`}>
          <rect x={x} y={height-30-h} width={barW} height={h} rx={3} fill={b.color} opacity={.85}/>
          <text x={x+barW/2} y={height-30-h-4} textAnchor="middle" fill={C.t3} fontSize={9}>{d[b.key]}</text>
        </g>;
      }))}
      {data.map((d,i) => (
        <text key={i} x={i*60+20} y={height-8} textAnchor="middle" fill={C.t3} fontSize={10}>{d[xKey]}</text>
      ))}
    </svg>
  );
};

/* ========== SIMPLE SVG LINE/AREA CHART ========== */
const SimpleLineChart = ({data, dataKey, height=180, color=C.blue, showArea=false, yMin, yMax}) => {
  const vals = data.map(d => d[dataKey]);
  const mn = yMin !== undefined ? yMin : Math.min(...vals);
  const mx = yMax !== undefined ? yMax : Math.max(...vals);
  const range = mx - mn || 1;
  const w = data.length * 60;
  const pts = data.map((d,i) => ({x: i*60+30, y: height - 30 - ((d[dataKey]-mn)/range)*(height-40)}));
  const pathD = pts.map((p,i) => `${i===0?'M':'L'}${p.x},${p.y}`).join(' ');
  const areaD = pathD + ` L${pts[pts.length-1].x},${height-30} L${pts[0].x},${height-30} Z`;
  return (
    <svg width="100%" height={height} viewBox={`0 0 ${w} ${height}`} style={{overflow:'visible'}}>
      {showArea && <path d={areaD} fill={color} opacity={.15}/>}
      <path d={pathD} fill="none" stroke={color} strokeWidth={2.5} strokeLinecap="round" strokeLinejoin="round"/>
      {pts.map((p,i) => <g key={i}>
        <circle cx={p.x} cy={p.y} r={4} fill={C.card} stroke={color} strokeWidth={2}/>
        <text x={p.x} y={p.y-10} textAnchor="middle" fill={C.t2} fontSize={10}>{vals[i]}</text>
        <text x={p.x} y={height-8} textAnchor="middle" fill={C.t3} fontSize={10}>{data[i].label||data[i].month||data[i].day||''}</text>
      </g>)}
    </svg>
  );
};

/* ========== DUAL AREA CHART ========== */
const DualAreaChart = ({data, keys, colors, height=180, xKey='hour'}) => {
  const allVals = data.flatMap(d => keys.map(k => d[k]));
  const mx = Math.max(...allVals);
  const w = data.length * 70;
  const makePts = (key) => data.map((d,i) => ({x:i*70+35, y: height-30-(d[key]/mx)*(height-40)}));
  const makePath = (pts) => pts.map((p,i) => `${i===0?'M':'L'}${p.x},${p.y}`).join(' ');
  const makeArea = (pts) => makePath(pts)+` L${pts[pts.length-1].x},${height-30} L${pts[0].x},${height-30} Z`;
  return (
    <svg width="100%" height={height} viewBox={`0 0 ${w} ${height}`} style={{overflow:'visible'}}>
      {keys.map((k,ki) => {
        const pts = makePts(k);
        return <g key={k}>
          <path d={makeArea(pts)} fill={colors[ki]} opacity={.12}/>
          <path d={makePath(pts)} fill="none" stroke={colors[ki]} strokeWidth={2} strokeLinejoin="round"/>
          {pts.map((p,i) => <circle key={i} cx={p.x} cy={p.y} r={3} fill={colors[ki]}/>)}
        </g>;
      })}
      {data.map((d,i) => (
        <text key={i} x={i*70+35} y={height-8} textAnchor="middle" fill={C.t3} fontSize={10}>{d[xKey]}</text>
      ))}
      <g transform={`translate(10,12)`}>
        {keys.map((k,ki) => <g key={k} transform={`translate(${ki*90},0)`}>
          <rect width={10} height={10} rx={2} fill={colors[ki]}/>
          <text x={14} y={9} fill={C.t2} fontSize={10}>{k}</text>
        </g>)}
      </g>
    </svg>
  );
};

/* ========== DATA ========== */
const masterAlerts = [
  {id:1,type:'critical',area:'Operaciones',msg:'Ruta CL‚ÜíCO fuera de SLA: 74 min (Meta: 60 min) ‚Äî Bancolombia intermitente',time:'2 min'},
  {id:2,type:'critical',area:'Customer Success',msg:'Contact Rate en 32% (Meta: <15%) ‚Äî Revisar deflection bot + volumen de casos',time:'5 min'},
  {id:3,type:'warning',area:'Tesorer√≠a',msg:'Liquidez Brasil al 84.8% del l√≠mite. Spread vs mercado +1.2% (meta <0.8%) ‚Äî AJUSTE REQUERIDO',time:'8 min'},
  {id:4,type:'warning',area:'Customer Success',msg:'450 Core Users migraron a At Risk esta semana ‚Äî Activar campa√±a retenci√≥n urgente',time:'12 min'},
  {id:5,type:'warning',area:'Tesorer√≠a',msg:'7 devoluciones pendientes ($4,230 USD) ‚Äî Oldest: 48h (SLA: 24h)',time:'15 min'},
  {id:6,type:'info',area:'Conciliaciones',msg:'Conciliaci√≥n CL‚ÜíVE completada: 99.5% match. 15 txns pendientes revisi√≥n manual',time:'22 min'},
];
const masterKPIs = [
  {label:'GMV Mensual',value:'$15.13M',change:'+11.4%',trend:'up',icon:'üí∞'},
  {label:'Transacciones',value:'364,908',change:'+7.9%',trend:'up',icon:'üìä'},
  {label:'Health Score',value:'68.4',change:'+2.3 pts',trend:'up',icon:'üíö'},
  {label:'Churn Rate',value:'8.7%',change:'Meta: <5%',trend:'down',icon:'üìâ'},
  {label:'Revenue B2B',value:'$176K',change:'+12.8%',trend:'up',icon:'üè¢'},
];
const opsData = {
  kpis: {
    txHoy: 16842,
    txAyer: 15921,
    usdMovilizado: 698420,
    usdAyer: 652180,
    latenciaPromedio: 1.2,
    tasaExitoGlobal: 96.8,
    proveedoresActivos: 12,
    proveedoresTotales: 14,
    acumuladoMes: 298420,
    acumuladoMesAnt: 278150,
  },
  alertas: [
    {tipo:'SLA Breach',severidad:'critical',proveedor:'Bancolombia',condicion:'success_rate 72% < SLA 85%',accion:'Failover autom√°tico activado',time:'3 min'},
    {tipo:'Cupo Cr√≠tico',severidad:'critical',proveedor:'Banco Plaza (Roraima)',condicion:'Cupo utilizado 92%',accion:'Recarga inmediata requerida',time:'8 min'},
    {tipo:'Retry Anomaly',severidad:'warning',proveedor:'Bradesco',condicion:'Reintentos 340 vs mediana 180 (+89%)',accion:'Investigar causa ra√≠z',time:'15 min'},
    {tipo:'Latency Spike',severidad:'warning',proveedor:'Pedro Rumbos',condicion:'Latencia 2.8s > p95 hist√≥rico 1.8s',accion:'Contactar proveedor',time:'22 min'},
    {tipo:'Ruta Contracci√≥n',severidad:'warning',proveedor:'BR‚ÜíVE',condicion:'Volumen -14% vs mismo per√≠odo mes anterior',accion:'An√°lisis de causa',time:'45 min'},
    {tipo:'Provider Down',severidad:'info',proveedor:'Cryptoalgo',condicion:'Sin heartbeat 3min ‚Äî Recuperado',accion:'Monitoreo post-incidente',time:'1h'},
  ],
  dispersion: [
    {pais:'Venezuela',proveedores:[
      {nombre:'Pedro Rumbos',latencia:820,tasaExito:94.2,sla:90,txHoy:3420,trend7d:'up',status:'ok'},
      {nombre:'Mercantil',latencia:650,tasaExito:99.1,sla:95,txHoy:2180,trend7d:'stable',status:'ok'},
      {nombre:'Banco Plaza (Roraima)',latencia:780,tasaExito:96.5,sla:92,txHoy:1850,trend7d:'up',status:'ok'},
      {nombre:'Banco Activo (Canaina)',latencia:920,tasaExito:91.8,sla:90,txHoy:1420,trend7d:'down',status:'warning'},
      {nombre:'Coincentral',latencia:1100,tasaExito:88.4,sla:85,txHoy:680,trend7d:'down',status:'warning'},
      {nombre:'Insular - N58',latencia:950,tasaExito:93.1,sla:90,txHoy:520,trend7d:'stable',status:'ok'},
    ]},
    {pais:'Colombia',proveedores:[
      {nombre:'Bancolombia',latencia:2800,tasaExito:72.1,sla:85,txHoy:1240,trend7d:'down',status:'critical'},
      {nombre:'Coink',latencia:1200,tasaExito:91.5,sla:88,txHoy:980,trend7d:'stable',status:'ok'},
      {nombre:'Cobre (v3)',latencia:1050,tasaExito:94.8,sla:90,txHoy:1120,trend7d:'up',status:'ok'},
    ]},
    {pais:'Per√∫',proveedores:[
      {nombre:'LigoPay',latencia:1400,tasaExito:88.2,sla:85,txHoy:620,trend7d:'stable',status:'ok'},
    ]},
    {pais:'Argentina',proveedores:[
      {nombre:'Remitee AR',latencia:1600,tasaExito:86.5,sla:82,txHoy:340,trend7d:'up',status:'ok'},
    ]},
  ],
  recaudo: [
    {pais:'Chile',proveedores:[
      {nombre:'Banco Estado',latencia:450,tasaExito:99.8,sla:95,txHoy:4820,trend7d:'up',status:'ok'},
    ]},
    {pais:'Europa',proveedores:[
      {nombre:'BVNK',latencia:680,tasaExito:97.2,sla:92,txHoy:1650,trend7d:'up',status:'ok'},
      {nombre:'Depasify',latencia:1200,tasaExito:89.4,sla:88,txHoy:420,trend7d:'down',status:'warning'},
      {nombre:'VirtualBroker',latencia:780,tasaExito:95.1,sla:90,txHoy:890,trend7d:'stable',status:'ok'},
    ]},
    {pais:'Colombia',proveedores:[
      {nombre:'Coink (Recaudo)',latencia:920,tasaExito:93.5,sla:90,txHoy:1280,trend7d:'stable',status:'ok'},
    ]},
    {pais:'Brasil',proveedores:[
      {nombre:'Transfero (PIX)',latencia:350,tasaExito:98.9,sla:95,txHoy:2100,trend7d:'up',status:'ok'},
    ]},
    {pais:'Per√∫',proveedores:[
      {nombre:'LigoPay (Recaudo)',latencia:1100,tasaExito:91.2,sla:88,txHoy:480,trend7d:'stable',status:'ok'},
    ]},
  ],
  reintentos: [
    {proveedor:'Pedro Rumbos',hoy:120,mediana30d:95,pct:126,status:'warning'},
    {proveedor:'Bancolombia',hoy:340,mediana30d:180,pct:189,status:'critical'},
    {proveedor:'Mercantil',hoy:45,mediana30d:52,pct:87,status:'ok'},
    {proveedor:'Banco Plaza',hoy:88,mediana30d:75,pct:117,status:'ok'},
    {proveedor:'Bradesco',hoy:210,mediana30d:120,pct:175,status:'critical'},
    {proveedor:'LigoPay',hoy:65,mediana30d:58,pct:112,status:'ok'},
    {proveedor:'BVNK',hoy:30,mediana30d:35,pct:86,status:'ok'},
    {proveedor:'Coink',hoy:78,mediana30d:70,pct:111,status:'ok'},
  ],
  volumenDiario: [
    {hora:'00',real:420,mediana:380},{hora:'02',real:180,mediana:210},{hora:'04',real:95,mediana:120},
    {hora:'06',real:310,mediana:280},{hora:'08',real:890,mediana:820},{hora:'10',real:1450,mediana:1320},
    {hora:'12',real:1820,mediana:1680},{hora:'14',real:1540,mediana:1490},{hora:'16',real:1680,mediana:1520},
    {hora:'18',real:1250,mediana:1180},{hora:'20',real:780,mediana:720},{hora:'22',real:450,mediana:420},
  ],
  rutasUSD: [
    {ruta:'CL ‚Üí VE',usdActual:182400,usdMesAnt:165200,delta:10.4},
    {ruta:'ES ‚Üí VE',usdActual:156800,usdMesAnt:148500,delta:5.6},
    {ruta:'CO ‚Üí VE',usdActual:128500,usdMesAnt:135200,delta:-5.0},
    {ruta:'BR ‚Üí VE',usdActual:98200,usdMesAnt:114500,delta:-14.2},
    {ruta:'PE ‚Üí VE',usdActual:72400,usdMesAnt:68900,delta:5.1},
    {ruta:'CL ‚Üí CO',usdActual:45200,usdMesAnt:38400,delta:17.7},
    {ruta:'EUR ‚Üí CO',usdActual:32100,usdMesAnt:28900,delta:11.1},
  ],
  cupos: [
    {proveedor:'Banco Plaza (Roraima)',movilizado:2850000,cupoTotal:3100000,saldo:250000,pctUtilizado:92,status:'critical'},
    {proveedor:'Banco Activo (Canaina)',movilizado:1980000,cupoTotal:2500000,saldo:520000,pctUtilizado:79,status:'warning'},
    {proveedor:'Coincentral',movilizado:820000,cupoTotal:1200000,saldo:380000,pctUtilizado:68,status:'ok'},
    {proveedor:'Pedro Rumbos',movilizado:1450000,cupoTotal:2000000,saldo:550000,pctUtilizado:73,status:'warning'},
    {proveedor:'Mercantil',movilizado:1200000,cupoTotal:2200000,saldo:1000000,pctUtilizado:55,status:'ok'},
    {proveedor:'Insular - N58',movilizado:450000,cupoTotal:800000,saldo:350000,pctUtilizado:56,status:'ok'},
  ],
  fase2: {
    healthScore: 78,
    mttr: '4.2 min',
    failoverRate: 3.8,
    costoPromTx: '$0.42',
    tasaCongelamiento: 1.2,
    churnCorredor: 2.1,
    colaPendientes: 34,
    proyeccionCupo: '18h',
  },
  criterios: [
    {criterio:'Tiempo detecci√≥n incidentes',baseline:'30‚Äì120 min',objetivo:'< 2 min',actual:'~5 min',status:'warning'},
    {criterio:'Tx fallidas por cupo agotado/mes',baseline:'150‚Äì300 tx',objetivo:'< 50 tx',actual:'82 tx',status:'warning'},
    {criterio:'Monitoreo manual diario',baseline:'2‚Äì3 horas',objetivo:'< 30 min',actual:'45 min',status:'warning'},
    {criterio:'Incidentes detectados proactivamente',baseline:'~10%',objetivo:'> 80%',actual:'65%',status:'warning'},
    {criterio:'Adopci√≥n diaria equipo ops',baseline:'N/A',objetivo:'> 90%',actual:'88%',status:'ok'},
  ],
};

const csData = {
  // 1. ATENCI√ìN AL CLIENTE (Tiempo Real)
  atencion: {
    casosActivos: 47,
    casosPorAgente: [
      {agente:'Mar√≠a L.',casos:6,status:'warning'},
      {agente:'Carlos R.',casos:4,status:'ok'},
      {agente:'Ana P.',casos:5,status:'ok'},
      {agente:'Pedro M.',casos:3,status:'ok'},
      {agente:'Laura S.',casos:5,status:'ok'},
    ],
    frt: '1:45', // min:seg
    tmo: '8:30', // min:seg
    csatLive: 4.2,
    deflectionRate: 62,
    fallbackRate: 38,
    contactRate: 32,
    contingencias: [
      {alerta:'Proveedor ca√≠do detectado (pay-in/pay-out)',status:'critical',detalle:'Bancolombia ‚Äî intermitente'},
      {alerta:'Volumen >150% promedio horario',status:'ok',detalle:'Actual: 110%'},
      {alerta:'FRT >5 min √∫ltimos 15 min',status:'ok',detalle:'FRT actual: 1:45 min'},
      {alerta:'3+ agentes offline hora pico',status:'ok',detalle:'Todos conectados'},
      {alerta:'Volumen 120-150% promedio',status:'ok',detalle:'Actual: 110%'},
      {alerta:'FRT entre 2-5 min',status:'ok',detalle:'FRT actual: 1:45 min'},
      {alerta:'Tasa de abandono >10%',status:'ok',detalle:'Actual: 6.2%'},
    ],
    volumenHora: [
      {hora:'00',real:12,promedio:15},{hora:'02',real:8,promedio:10},{hora:'04',real:5,promedio:7},
      {hora:'06',real:15,promedio:18},{hora:'08',real:45,promedio:38},{hora:'10',real:67,promedio:55},
      {hora:'12',real:82,promedio:72},{hora:'14',real:74,promedio:68},{hora:'16',real:68,promedio:62},
      {hora:'18',real:52,promedio:48},{hora:'20',real:35,promedio:30},{hora:'22',real:20,promedio:18},
    ],
    topMotivos: [
      {motivo:'Remesa demorada',casos:234,pct:28,trend:'up',trendPct:45,avgTime:'18 min'},
      {motivo:'KYC rechazado',casos:156,pct:19,trend:'up',trendPct:12,avgTime:'22 min'},
      {motivo:'M√©todo pago falla',casos:89,pct:11,trend:'down',trendPct:5,avgTime:'8 min'},
      {motivo:'Seguimiento env√≠o',casos:78,pct:9,trend:'up',trendPct:8,avgTime:'12 min'},
      {motivo:'Beneficiario equivocado',casos:45,pct:5,trend:'down',trendPct:3,avgTime:'15 min'},
    ],
    canales: {whatsapp:65,inApp:25,email:10},
  },

  // 2. FRICCI√ìN EN CUSTOMER JOURNEY
  friccion: {
    etapas: [
      {etapa:'Registro',usuarios:10000,casosSupport:45,friccion:12,topMotivo:'C√≥digo SMS no llega',accion:'Monitorear',color:C.green,trend:'down'},
      {etapa:'KYC',usuarios:9200,casosSupport:234,friccion:67,topMotivo:'Documento rechazado',accion:'URGENTE: Proyecto con Producto',color:C.red,trend:'up'},
      {etapa:'1ra Remesa',usuarios:6500,casosSupport:156,friccion:45,topMotivo:'M√©todo pago falla',accion:'Escalar a Ops + Producto',color:C.orange,trend:'stable'},
      {etapa:'2da Remesa',usuarios:4200,casosSupport:89,friccion:28,topMotivo:'Incentivo insuficiente',accion:'Propuesta a Growth',color:C.yellow,trend:'stable'},
    ],
    activationRate: 72,
    activationTrend: -3.2,
    activationCausa: 'Fricci√≥n en KYC',
    medianaActivacion: 18, // days
    metaActivacion: 21, // days
  },

  // 3. SALUD DE LA BASE DE USUARIOS
  segments: [
    {name:'Power Users',count:8420,pct:8.4,avgTxMonth:12.3,ltv:2847,churnRate:2.1,nps:92,contactRate:8,trend:'+2.3%',trendDir:'up',risk:'low',color:'#8b5cf6'},
    {name:'Core Users',count:34500,pct:34.5,avgTxMonth:4.2,ltv:892,churnRate:5.8,nps:86,contactRate:12,trend:'+0.5%',trendDir:'stable',risk:'low',color:'#3b82f6'},
    {name:'Casual Users',count:41200,pct:41.2,avgTxMonth:1.1,ltv:234,churnRate:12.4,nps:68,contactRate:18,trend:'-3.8%',trendDir:'down',risk:'medium',color:'#f59e0b'},
    {name:'At Risk',count:7200,pct:7.2,avgTxMonth:0.3,ltv:89,churnRate:35.2,nps:45,contactRate:28,trend:'-12.1%',trendDir:'down',risk:'high',color:'#f97316'},
    {name:'Very At Risk',count:3800,pct:3.8,avgTxMonth:0.1,ltv:34,churnRate:58.7,nps:31,contactRate:35,trend:'-18.5%',trendDir:'down',risk:'critical',color:'#ef4444'},
    {name:'Dormant',count:15880,pct:15.9,avgTxMonth:0,ltv:0,churnRate:78.2,nps:null,contactRate:null,trend:'-5.2%',trendDir:'down',risk:'lost',color:'#6b7280'},
  ],

  // 4. HEALTH SCORE
  healthScore: {
    promedio: 68.4,
    meta: 75,
    trend30d: '+4.6 pts',
    distribucion: [
      {label:'Saludable (80-100)',count:42920,pct:42.9,color:C.green},
      {label:'Monitor (60-79)',count:31700,pct:31.7,color:C.yellow},
      {label:'At Risk (40-59)',count:18500,pct:18.5,color:C.orange},
      {label:'Cr√≠tico (0-39)',count:6880,pct:6.9,color:C.red},
    ],
    evolucion: [
      {mes:'Sep',score:61.2,pctSaludables:35.4,pctRisk:34.8},
      {mes:'Oct',score:63.8,pctSaludables:38.7,pctRisk:31.2},
      {mes:'Nov',score:66.1,pctSaludables:41.2,pctRisk:27.8},
      {mes:'Dic',score:68.4,pctSaludables:42.9,pctRisk:25.4},
    ],
    componentes: [
      {nombre:'Recencia',peso:25,desc:'D√≠as desde √∫ltima tx'},
      {nombre:'Frecuencia',peso:25,desc:'Tx/mes vs promedio segmento'},
      {nombre:'Experiencia',peso:25,desc:'NPS + casos soporte (inverso)'},
      {nombre:'Engagement',peso:15,desc:'Logins/mes + canales usados'},
      {nombre:'Trend',peso:10,desc:'Direcci√≥n de frecuencia'},
    ],
  },

  // 5. RETENCI√ìN & REACTIVACI√ìN
  retencion: {
    curva: [
      {mes:'M1',rate:82},{mes:'M2',rate:71},{mes:'M3',rate:60},
      {mes:'M6',rate:48},{mes:'M12',rate:38},
    ],
    benchmarks: {m3:'55-65%',m6:'40-50%',m12:'30-40%'},
    estrategias: [
      {nombre:'Email recordatorio',segmento:'At Risk',usuarios:7200,status:'active',tasaReactivacion:8.2,proximaRevision:'Semanal',mensaje:'"Tu familia te extra√±a. Env√≠a hoy con 0% comisi√≥n"'},
      {nombre:'WhatsApp incentivo',segmento:'Very At Risk',usuarios:3800,status:'active',tasaReactivacion:5.1,proximaRevision:'Semanal',mensaje:'"$5 gratis en tu pr√≥xima remesa"'},
      {nombre:'Campa√±a dormant Q1',segmento:'Dormant',usuarios:15880,status:'planned',tasaReactivacion:null,proximaRevision:'15-Feb',mensaje:'Beneficio fuerte + caso de uso nuevo'},
    ],
  },

  // 6. EXPERIENCIA DEL USUARIO
  experiencia: {
    nps: 86,
    csat: 4.2,
    ces: 91,
    contactRate: 32,
    npsPorSegmento: [
      {segmento:'Power Users',nps:92,trend:'+3',detractores:2,pasivos:12,promotores:86},
      {segmento:'Core Users',nps:86,trend:'0',detractores:5,pasivos:18,promotores:77},
      {segmento:'Casual Users',nps:68,trend:'-4',detractores:12,pasivos:32,promotores:56},
      {segmento:'At Risk',nps:45,trend:'-8',detractores:35,pasivos:40,promotores:25},
    ],
    npsPorPais: [
      {pais:'Chile',nps:88,csat:4.3,casosPer1k:85,topFriccion:'M√©todos de pago'},
      {pais:'Colombia',nps:58,csat:3.8,casosPer1k:245,topFriccion:'Remesas demoradas'},
      {pais:'Per√∫',nps:82,csat:4.1,casosPer1k:110,topFriccion:'KYC rechazos'},
      {pais:'Espa√±a',nps:91,csat:4.4,casosPer1k:65,topFriccion:'N/A'},
      {pais:'Brasil',nps:76,csat:4.0,casosPer1k:180,topFriccion:'Proveedores ca√≠dos'},
    ],
    contactRatePorSegmento: [
      {segmento:'Power Users',rate:8},{segmento:'Core Users',rate:12},{segmento:'Casual Users',rate:18},
      {segmento:'At Risk',rate:28},{segmento:'Very At Risk',rate:35},
    ],
  },

  // 7. ALERTAS INTELIGENTES
  alertas: [
    {prioridad:'critical',msg:'KYC fricci√≥n subi√≥ 15% esta semana (67% actual)',accion:'Proyecto urgente con Producto para simplificar flujo',owner:'CS lidera, Producto ejecuta',plazo:'2 semanas'},
    {prioridad:'critical',msg:'450 Core Users migraron a At Risk esta semana',accion:'Activar campa√±a de retenci√≥n inmediata',owner:'CS define, Growth ejecuta',plazo:'3 d√≠as'},
    {prioridad:'critical',msg:'Proveedor Bancolombia intermitente ‚Äî impacto en CO',accion:'Contingencia activada, contacto proactivo usuarios CO',owner:'CS + Ops',plazo:'Inmediato'},
    {prioridad:'high',msg:'NPS Colombia en 58 (normal: 72)',accion:'Investigar causa ra√≠z (casos soporte + NPS comments)',owner:'CS an√°lisis',plazo:'5 d√≠as'},
    {prioridad:'high',msg:'23 Power Users bajaron frecuencia >40%',accion:'Contacto personalizado inmediato',owner:'CS retenci√≥n',plazo:'3 d√≠as'},
    {prioridad:'medium',msg:'Casual Users tendencia -3.8% ‚Üí riesgo migraci√≥n a At Risk',accion:'Monitorear + propuesta engagement',owner:'CS + Growth',plazo:'Esta semana'},
    {prioridad:'positive',msg:'Fricci√≥n Registro baj√≥ de 15% a 12% ‚Üí mejora en SMS',accion:'Documentar y celebrar',owner:'CS',plazo:'N/A'},
    {prioridad:'positive',msg:'Estrategia At Risk logr√≥ 8.2% reactivaci√≥n (meta: >8%)',accion:'Escalar y optimizar',owner:'CS + Growth',plazo:'Continuo'},
  ],

  // 8. M√âTRICAS DE √âXITO DE CS
  metricasExito: [
    {metrica:'Contact Rate',meta:'<15%',actual:'32%',status:'critical'},
    {metrica:'NPS Global',meta:'>70',actual:'86',status:'ok'},
    {metrica:'Activation Rate',meta:'>80%',actual:'72%',status:'warning'},
    {metrica:'Churn Rate Mensual',meta:'<5%',actual:'8.7%',status:'critical'},
    {metrica:'% Usuarios Saludables',meta:'>55%',actual:'42.9%',status:'warning'},
    {metrica:'Fricci√≥n Cr√≠tica (>60%)',meta:'0 etapas',actual:'1 etapa (KYC)',status:'critical'},
  ],

  churnRate: 8.7,
};

const treasuryData = {
  liquidity:[
    {country:'Argentina',saldo:2345678,limite:5000000,uso:46.9,proyeccion24h:62,trend:'Estable',status:'ok'},
    {country:'Brasil',saldo:456789,limite:3000000,uso:84.8,proyeccion24h:98,trend:'Cr√≠tico',status:'critical'},
    {country:'M√©xico',saldo:2789012,limite:4000000,uso:69.7,proyeccion24h:80,trend:'Acelerado',status:'warning'},
    {country:'Colombia',saldo:890234,limite:2000000,uso:44.5,proyeccion24h:55,trend:'Estable',status:'ok'},
    {country:'Chile',saldo:1456789,limite:2500000,uso:58.3,proyeccion24h:76,trend:'Acelerado',status:'warning'},
    {country:'Per√∫',saldo:1234567,limite:2000000,uso:61.7,proyeccion24h:72,trend:'Moderado',status:'ok'},
  ],
  tiposCambio:[
    {moneda:'CLP',valor:987.50,cambio:'+0.8%',trend:'up'},
    {moneda:'BRL',valor:5.73,cambio:'+1.2%',trend:'up'},
    {moneda:'EUR',valor:0.92,cambio:'-0.3%',trend:'down'},
    {moneda:'COP',valor:4325.80,cambio:'+0.5%',trend:'up'},
    {moneda:'ARS',valor:1087.25,cambio:'+2.4%',trend:'up'},
    {moneda:'PEN',valor:3.72,cambio:'+0.2%',trend:'up'},
    {moneda:'MXN',valor:17.45,cambio:'-0.6%',trend:'down'},
    {moneda:'VES',valor:52.18,cambio:'+3.1%',trend:'up'},
  ],
  tiposCambioRetorna:[
    {moneda:'CLP',valor:995.20,spread:'+0.78%'},
    {moneda:'BRL',valor:5.81,spread:'+1.40%'},
    {moneda:'EUR',valor:0.91,spread:'-1.09%'},
    {moneda:'COP',valor:4368.50,spread:'+0.99%'},
    {moneda:'ARS',valor:1098.15,spread:'+1.00%'},
    {moneda:'PEN',valor:3.75,spread:'+0.81%'},
    {moneda:'MXN',valor:17.62,spread:'+0.97%'},
    {moneda:'VES',valor:53.45,spread:'+2.43%'},
  ],
  liquidezPartners:{
    recaudacion:[
      {proveedor:'TRANSFERO',moneda:'BRL',balance:264225.79,ultimaAct:'10/2/2026, 10:04'},
      {proveedor:'BANCO ESTADO',moneda:'CLP',balance:430432212,ultimaAct:'10/2/2026, 10:04'},
      {proveedor:'COINK',moneda:'COP',balance:1469890216.96,ultimaAct:'10/2/2026, 10:04'},
      {proveedor:'DEPASIFY',moneda:'EUR',balance:-756.1016,ultimaAct:'10/2/2026, 9:59'},
      {proveedor:'VIRTUABROKER',moneda:'EUR',balance:53901.00,ultimaAct:'10/2/2026, 9:59'},
      {proveedor:'BVNK',moneda:'EUR',balance:549786,ultimaAct:'10/2/2026, 10:04'},
      {proveedor:'LIGOPAY',moneda:'PEN',balance:126117.05,ultimaAct:'10/2/2026, 10:04'},
      {proveedor:'N58',moneda:'VES',balance:10000000,ultimaAct:'10/2/2026, 10:04'},
    ],
    dispersion:[
      {proveedor:'Conk',compania:'-',moneda:'COP',balance:99847935.11,ultimaAct:'10/2/2026, 10:00'},
      {proveedor:'Cobre',compania:'v3',moneda:'COP',balance:153673696.61,ultimaAct:'10/2/2026, 10:00'},
      {proveedor:'Remitee Colombia',compania:'co',moneda:'USD',balance:7600.70,ultimaAct:'10/2/2026, 10:00'},
      {proveedor:'Remitee Chile',compania:'cl',moneda:'USD',balance:19758.17,ultimaAct:'10/2/2026, 9:55'},
      {proveedor:'CBPay',compania:'-',moneda:'USDT',balance:0.2904,ultimaAct:'10/2/2026, 10:00'},
      {proveedor:'Banco Plaza',compania:'roraima',moneda:'VES',balance:70090244.96,ultimaAct:'10/2/2026, 9:55'},
      {proveedor:'Banco Activo',compania:'roraima',moneda:'VES',balance:17692881.15,ultimaAct:'10/2/2026, 10:00'},
      {proveedor:'Banco Activo',compania:'canaina',moneda:'VES',balance:86212900.97,ultimaAct:'10/2/2026, 9:55'},
      {proveedor:'Banco Plaza',compania:'canaina',moneda:'VES',balance:92013684.40,ultimaAct:'10/2/2026, 9:15'},
      {proveedor:'Coincentral',compania:'-',moneda:'VES',balance:15000000,ultimaAct:'10/2/2026, 10:00'},
      {proveedor:'Insular - N58',compania:'-',moneda:'VES',balance:3321345,ultimaAct:'10/2/2026, 10:04'},
    ]
  },
  totalLiquidity:86470,liqRecaudacion:35180,liqOperativa:34120,liqTransito:17170,
  tiempoRetornoFondos:7.2,
  realtime:[
    {id:1,metric:'Saldo disponible',value:'$86.47K',status:'ok',action:'Redistribuci√≥n de la Dispersi√≥n ‚Äî Requerimiento de Fondeo',kpi:'Tiempo de Fondeo',detail:'Cobertura 4.2h al ritmo actual'},
    {id:2,metric:'Posici√≥n de Mercado',value:'CLP/VES 3,842',status:'warning',action:'Alerta de ajuste o mejora en los tipos de cambio',kpi:'Fx Rate Positions',detail:'Spread vs mercado: +1.2% (meta <0.8%)'},
    {id:3,metric:'Estatus de devoluciones',value:'7 pendientes',status:'critical',action:'Seguimiento de devoluciones a cuenta bancaria pendientes de ejecutar',kpi:'Time to Refund',detail:'$4,230 USD ‚Äî Oldest: 48h (SLA: 24h)'},
    {id:4,metric:'Revenue real time',value:'$12,840',status:'ok',action:'Alerta de ajuste o mejora en la configuraci√≥n de Pricing',kpi:'Revenue',detail:'vs target diario $14K ‚Äî 91.7% cumplimiento'},
  ],
  rentabilidad:[
    {ruta:'CL ‚Üí VE',margenConfigurado:6.5,volumenTransado:4200000,participacion:28},
    {ruta:'CO ‚Üí VE',margenConfigurado:5.5,volumenTransado:3100000,participacion:21},
    {ruta:'PE ‚Üí VE',margenConfigurado:4.8,volumenTransado:1800000,participacion:12},
    {ruta:'BR ‚Üí VE',margenConfigurado:3.2,volumenTransado:2400000,participacion:16},
    {ruta:'ES ‚Üí VE',margenConfigurado:7.1,volumenTransado:3800000,participacion:23},
  ],
  rentabilidadSecundarias:[
    {ruta:'VE ‚Üí CO',destino:'CO',margenConfigurado:5.2,volumenTransado:1200000,participacion:18},
    {ruta:'CL ‚Üí CO',destino:'CO',margenConfigurado:4.8,volumenTransado:890000,participacion:13},
    {ruta:'PE ‚Üí CO',destino:'CO',margenConfigurado:4.5,volumenTransado:750000,participacion:11},
    {ruta:'BR ‚Üí CO',destino:'CO',margenConfigurado:3.9,volumenTransado:650000,participacion:10},
    {ruta:'ES ‚Üí CO',destino:'CO',margenConfigurado:6.1,volumenTransado:1100000,participacion:16},
    {ruta:'VE ‚Üí AR',destino:'AR',margenConfigurado:4.3,volumenTransado:680000,participacion:22},
    {ruta:'CL ‚Üí AR',destino:'AR',margenConfigurado:3.8,volumenTransado:520000,participacion:17},
    {ruta:'PE ‚Üí AR',destino:'AR',margenConfigurado:4.1,volumenTransado:590000,participacion:19},
    {ruta:'BR ‚Üí AR',destino:'AR',margenConfigurado:3.2,volumenTransado:450000,participacion:15},
    {ruta:'CO ‚Üí AR',destino:'AR',margenConfigurado:4.7,volumenTransado:620000,participacion:20},
    {ruta:'VE ‚Üí US',destino:'US',margenConfigurado:7.8,volumenTransado:2100000,participacion:28},
    {ruta:'CL ‚Üí US',destino:'US',margenConfigurado:6.9,volumenTransado:1800000,participacion:24},
    {ruta:'CO ‚Üí US',destino:'US',margenConfigurado:7.2,volumenTransado:1950000,participacion:26},
    {ruta:'PE ‚Üí US',destino:'US',margenConfigurado:6.5,volumenTransado:1500000,participacion:20},
    {ruta:'VE ‚Üí ES',destino:'ES',margenConfigurado:6.8,volumenTransado:1350000,participacion:27},
    {ruta:'CO ‚Üí ES',destino:'ES',margenConfigurado:6.2,volumenTransado:1150000,participacion:23},
    {ruta:'CL ‚Üí ES',destino:'ES',margenConfigurado:6.5,volumenTransado:1250000,participacion:25},
    {ruta:'PE ‚Üí ES',destino:'ES',margenConfigurado:5.9,volumenTransado:980000,participacion:20},
    {ruta:'VE ‚Üí PE',destino:'PE',margenConfigurado:5.1,volumenTransado:920000,participacion:24},
    {ruta:'CO ‚Üí PE',destino:'PE',margenConfigurado:4.7,volumenTransado:810000,participacion:21},
    {ruta:'CL ‚Üí PE',destino:'PE',margenConfigurado:4.9,volumenTransado:870000,participacion:23},
    {ruta:'BR ‚Üí PE',destino:'PE',margenConfigurado:4.2,volumenTransado:720000,participacion:19},
    {ruta:'AR ‚Üí PE',destino:'PE',margenConfigurado:4.6,volumenTransado:780000,participacion:20},
  ],
  rentabilidadB2B:{
    remitee:[
      {mes:'SALDO INICIAL',abonos:168250,cargos:null,totalSaldo:168250.49,comision:'2,18%',qtyMov:1,ingresoComision:null,ingresoDifTC:null,totalIngreso:null,rentReal:null},
      {mes:'ENERO 26',abonos:3192145,cargos:3143605,totalSaldo:216791.36,comision:'2,18% - 2,15%',qtyMov:90317,ingresoComision:68037.50,ingresoDifTC:103917.34,totalIngreso:171954.84,rentReal:5.470},
      {mes:'FEBRERO 26',abonos:204398,cargos:200854,totalSaldo:220335.05,comision:'2,18%',qtyMov:5642,ingresoComision:4378.62,ingresoDifTC:0,totalIngreso:4378.62,rentReal:2.180},
    ],
    imi:[
      {mes:'SALDO INICIAL',abonos:500,cargos:null,totalSaldo:500.00,comision:'0,00%',qtyMov:1,ingresoComision:null,ingresoDifTC:null,totalIngreso:null,rentReal:null},
      {mes:'ENERO 26',abonos:2999,cargos:3480,totalSaldo:19.39,comision:'0,00%',qtyMov:62,ingresoComision:null,ingresoDifTC:115.87,totalIngreso:115.87,rentReal:3.33},
      {mes:'FEBRERO 26',abonos:null,cargos:15,totalSaldo:4.61,comision:'0,00%',qtyMov:1,ingresoComision:null,ingresoDifTC:null,totalIngreso:null,rentReal:null},
    ],
    cliente3:[
      {mes:'SALDO INICIAL',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
      {mes:'ENERO 26',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
      {mes:'FEBRERO 26',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
    ],
    cliente4:[
      {mes:'SALDO INICIAL',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
      {mes:'ENERO 26',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
      {mes:'FEBRERO 26',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
    ],
    cliente5:[
      {mes:'SALDO INICIAL',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
      {mes:'ENERO 26',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
      {mes:'FEBRERO 26',abonos:0,cargos:0,totalSaldo:0,comision:0,qtyMov:0,ingresoComision:0,ingresoDifTC:0,totalIngreso:0,rentReal:0},
    ],
  },
  cashflowHourly:[
    {hour:'00',ingresos:12000,egresos:8000},{hour:'04',ingresos:5000,egresos:15000},
    {hour:'08',ingresos:45000,egresos:32000},{hour:'12',ingresos:67000,egresos:54000},
    {hour:'16',ingresos:52000,egresos:48000},{hour:'20',ingresos:34000,egresos:28000},
  ],
  competencia:{
    rutasPrincipales:[
      {
        ruta:'CL ‚Üí VE',
        posicionRetorna:2,
        tasaRetorna:'0,625',
        ranking:[
          {pos:1,empresa:'Vitawallet',tasa:'0,629'},
          {pos:2,empresa:'Retorna usuario nuevo',tasa:'0,625',destacar:true},
          {pos:3,empresa:'Tucambio CL',tasa:'0,597'},
          {pos:4,empresa:'Retorna usuario frecuente',tasa:'0,590',destacar:true},
          {pos:5,empresa:'Bithonor',tasa:'0,588'},
          {pos:6,empresa:'Quickex',tasa:'0,578'},
          {pos:7,empresa:'Arcadi',tasa:'0,578'},
          {pos:8,empresa:'Money Gram',tasa:'0,557'},
        ]
      },
      {
        ruta:'CO ‚Üí VE',
        posicionRetorna:2,
        tasaRetorna:'6,96',
        ranking:[
          {pos:1,empresa:'Vitawallet',tasa:'6,776952'},
          {pos:2,empresa:'Retorna usuario nuevo',tasa:'6,96',destacar:true},
          {pos:3,empresa:'Arcadi',tasa:'7,14643'},
          {pos:4,empresa:'Bithonor',tasa:'7,15'},
          {pos:5,empresa:'Retorna usuario frecuente',tasa:'7,25',destacar:true},
          {pos:6,empresa:'Global66',tasa:'8,847751'},
          {pos:7,empresa:'Intergiros',tasa:'9,25'},
          {pos:8,empresa:'Papaya',tasa:'9,512292'},
        ]
      },
      {
        ruta:'EUR ‚Üí VE',
        posicionRetorna:1,
        tasaRetorna:'630,022',
        ranking:[
          {pos:1,empresa:'Retorna',tasa:'630,022',destacar:true},
          {pos:2,empresa:'Bithonor',tasa:'601,720'},
          {pos:3,empresa:'Curiara',tasa:'585,380'},
          {pos:4,empresa:'Remitven',tasa:'573,300'},
          {pos:5,empresa:'RIA',tasa:'570,850'},
          {pos:6,empresa:'Money Gram',tasa:'552,220'},
          {pos:7,empresa:'Western Union',tasa:'465,742'},
        ]
      },
      {
        ruta:'PE ‚Üí VE',
        posicionRetorna:1,
        tasaRetorna:'172,45',
        ranking:[
          {pos:1,empresa:'Retorna usuario nuevo',tasa:'172,45',destacar:true},
          {pos:2,empresa:'Vitawallet',tasa:'171,82'},
          {pos:3,empresa:'Retorna usuario frecuente',tasa:'169,78',destacar:true},
          {pos:4,empresa:'Bithonor',tasa:'168,92'},
          {pos:5,empresa:'Arcadi',tasa:'166,54'},
          {pos:6,empresa:'Money Gram',tasa:'158,32'},
        ]
      },
      {
        ruta:'BR ‚Üí VE',
        posicionRetorna:3,
        tasaRetorna:'0,0912',
        ranking:[
          {pos:1,empresa:'Vitawallet',tasa:'0,0925'},
          {pos:2,empresa:'Bithonor',tasa:'0,0918'},
          {pos:3,empresa:'Retorna usuario nuevo',tasa:'0,0912',destacar:true},
          {pos:4,empresa:'Arcadi',tasa:'0,0905'},
          {pos:5,empresa:'Retorna usuario frecuente',tasa:'0,0898',destacar:true},
          {pos:6,empresa:'Remitven',tasa:'0,0887'},
        ]
      },
    ],
    rutasSecundarias:[
      {ruta:'CL ‚Üí CO',posicionRetorna:2,tasaRetorna:'4,85',totalCompetidores:6,destino:'CO'},
      {ruta:'EUR ‚Üí CO',posicionRetorna:1,tasaRetorna:'4,92',totalCompetidores:5,destino:'CO'},
      {ruta:'PE ‚Üí CO',posicionRetorna:3,tasaRetorna:'4,78',totalCompetidores:7,destino:'CO'},
      {ruta:'BR ‚Üí CO',posicionRetorna:2,tasaRetorna:'4,81',totalCompetidores:6,destino:'CO'},
      {ruta:'CL ‚Üí AR',posicionRetorna:1,tasaRetorna:'0,987',totalCompetidores:5,destino:'AR'},
      {ruta:'CO ‚Üí AR',posicionRetorna:2,tasaRetorna:'0,982',totalCompetidores:6,destino:'AR'},
      {ruta:'EUR ‚Üí AR',posicionRetorna:1,tasaRetorna:'0,991',totalCompetidores:4,destino:'AR'},
      {ruta:'PE ‚Üí AR',posicionRetorna:2,tasaRetorna:'0,985',totalCompetidores:5,destino:'AR'},
      {ruta:'BR ‚Üí AR',posicionRetorna:1,tasaRetorna:'0,989',totalCompetidores:5,destino:'AR'},
      {ruta:'CL ‚Üí US',posicionRetorna:2,tasaRetorna:'0,98',totalCompetidores:8,destino:'US'},
      {ruta:'CO ‚Üí US',posicionRetorna:3,tasaRetorna:'0,97',totalCompetidores:9,destino:'US'},
      {ruta:'EUR ‚Üí US',posicionRetorna:2,tasaRetorna:'1,02',totalCompetidores:7,destino:'US'},
      {ruta:'PE ‚Üí US',posicionRetorna:2,tasaRetorna:'0,99',totalCompetidores:8,destino:'US'},
      {ruta:'BR ‚Üí US',posicionRetorna:3,tasaRetorna:'0,96',totalCompetidores:8,destino:'US'},
      {ruta:'CL ‚Üí ES',posicionRetorna:1,tasaRetorna:'0,92',totalCompetidores:6,destino:'ES'},
      {ruta:'CO ‚Üí ES',posicionRetorna:2,tasaRetorna:'0,91',totalCompetidores:7,destino:'ES'},
      {ruta:'PE ‚Üí ES',posicionRetorna:1,tasaRetorna:'0,93',totalCompetidores:5,destino:'ES'},
      {ruta:'BR ‚Üí ES',posicionRetorna:2,tasaRetorna:'0,90',totalCompetidores:6,destino:'ES'},
      {ruta:'CL ‚Üí PE',posicionRetorna:1,tasaRetorna:'3,78',totalCompetidores:6,destino:'PE'},
      {ruta:'CO ‚Üí PE',posicionRetorna:2,tasaRetorna:'3,75',totalCompetidores:7,destino:'PE'},
      {ruta:'EUR ‚Üí PE',posicionRetorna:1,tasaRetorna:'3,82',totalCompetidores:5,destino:'PE'},
      {ruta:'BR ‚Üí PE',posicionRetorna:2,tasaRetorna:'3,76',totalCompetidores:6,destino:'PE'},
    ]
  },
};

const reconData = {
  summary:{total:12847,matched:12698,pending:112,discrepancy:37,matchRate:98.8},
  byProvider: [
    {tipo:'Payouts',proveedor:'Banco Plaza',pais:'Venezuela',total:2800,matched:2785,pending:10,discrepancy:5,rate:99.5,status:'ok'},
    {tipo:'Payouts',proveedor:'Banco Activo',pais:'Venezuela',total:2200,matched:2156,pending:28,discrepancy:16,rate:98.0,status:'warning'},
    {tipo:'Payouts',proveedor:'Coincentral',pais:'Venezuela',total:680,matched:672,pending:5,discrepancy:3,rate:98.8,status:'ok'},
    {tipo:'Payouts',proveedor:'Mercantil',pais:'Venezuela',total:1450,matched:1445,pending:3,discrepancy:2,rate:99.7,status:'ok'},
    {tipo:'Payouts',proveedor:'Cobre (v3)',pais:'Colombia',total:1120,matched:1098,pending:15,discrepancy:7,rate:98.0,status:'warning'},
    {tipo:'Payouts',proveedor:'LigoPay',pais:'Per√∫',total:620,matched:614,pending:4,discrepancy:2,rate:99.0,status:'ok'},
    {tipo:'Payins',proveedor:'Banco Estado',pais:'Chile',total:4820,matched:4810,pending:8,discrepancy:2,rate:99.8,status:'ok'},
    {tipo:'Payins',proveedor:'BVNK',pais:'Europa',total:1650,matched:1622,pending:18,discrepancy:10,rate:98.3,status:'warning'},
    {tipo:'Payins',proveedor:'Transfero (PIX)',pais:'Brasil',total:2100,matched:2092,pending:6,discrepancy:2,rate:99.6,status:'ok'},
    {tipo:'Payins',proveedor:'Coink',pais:'Colombia',total:1280,matched:1264,pending:12,discrepancy:4,rate:98.8,status:'ok'},
  ],
  discrepancyTypes:[
    {type:'Monto no coincide',count:15,pct:40.5},
    {type:'Tx no encontrada en proveedor',count:9,pct:24.3},
    {type:'Doble cobro detectado',count:6,pct:16.2},
    {type:'Estado inconsistente',count:4,pct:10.8},
    {type:'Otros',count:3,pct:8.1},
  ],
  timeline:[
    {day:'Lun',matched:98.9},{day:'Mar',matched:99.1},{day:'Mi√©',matched:98.5},
    {day:'Jue',matched:98.8},{day:'Vie',matched:97.2},{day:'S√°b',matched:99.4},{day:'Dom',matched:99.6},
  ],
  alerts:[
    {type:'critical',msg:'BR‚ÜíVE: 10 discrepancias de monto > $500 USD pendientes',time:'5 min'},
    {type:'warning',msg:'CO‚ÜíVE: Conciliaci√≥n retrasada 45 min vs SLA (30 min)',time:'20 min'},
    {type:'info',msg:'CL‚ÜíVE: Conciliaci√≥n autom√°tica completada ‚Äî 99.5% match',time:'1h'},
  ],
  realtime:[
    {id:5,metric:'% conciliado por canal',value:'94.2%',status:'warning',action:'Alerta por discrepancias en caso negativo, con el detalle',kpi:'Conciliaci√≥n transaccional',detail:'Bancolombia: 87.1% | Banco Estado: 99.5% | BVNK: 96.8%'},
    {id:6,metric:'√öltima conciliaci√≥n',value:'Hace 22 min',status:'ok',action:'Alerta por d√≠as de demora y explicaci√≥n del motivo',kpi:'Conciliaci√≥n transaccional',detail:'CL‚ÜíVE: 22min | CO‚ÜíVE: 45min (retrasada) | BR‚ÜíVE: 35min'},
    {id:7,metric:'Backlog discrepancias',value:'37 pendientes',status:'critical',action:'Escalaci√≥n en base a d√≠as de demora, monto en riesgo y responsables',kpi:'P√©rdidas/reclamos',detail:'$12,450 USD en riesgo ‚Äî Oldest: 5 d√≠as | Responsable: Ops Team'},
    {id:8,metric:'Validaci√≥n saldos',value:'3 diferencias',status:'warning',action:'Saldo banco vs. "contable"',kpi:'Controles',detail:'Bancolombia: -$234 | Banco Plaza: +$1,200 | Bradesco: -$89'},
  ],
};

/* ========== UI ATOMS ========== */
const Dot = ({status,size=8}) => {
  const color = status==='ok'||status==='green'?C.green : status==='warning'||status==='yellow'?C.yellow : status==='degraded'||status==='orange'?C.orange : C.red;
  return <span className={status==='critical'?'pulse-dot':''} style={{display:'inline-block',width:size,height:size,borderRadius:'50%',backgroundColor:color,marginRight:8,flexShrink:0}}/>;
};
const Badge = ({children,color=C.blue}) => (
  <span style={{display:'inline-block',padding:'2px 8px',borderRadius:12,fontSize:11,fontWeight:600,backgroundColor:`${color}22`,color,border:`1px solid ${color}44`}}>{children}</span>
);
const Card = ({children,style,onClick,hoverable}) => {
  const [hov,setHov] = useState(false);
  return <div onClick={onClick}
    onMouseEnter={()=>setHov(true)} onMouseLeave={()=>setHov(false)}
    style={{background:C.card,borderRadius:12,border:`1px solid ${hov&&(hoverable||onClick)?C.blue:C.border}`,
      padding:20,cursor:onClick?'pointer':'default',transition:'all .2s',
      transform:hov&&(hoverable||onClick)?'translateY(-2px)':'none',...style}}>
    {children}
  </div>;
};
const Bar = ({value,max=100,color,height=8}) => {
  const c = color||(value>=90?C.green:value>=70?C.yellow:value>=50?C.orange:C.red);
  return <div style={{width:'100%',height,backgroundColor:'#1f2937',borderRadius:height/2,overflow:'hidden'}}>
    <div style={{width:`${Math.min(value,max)}%`,height:'100%',backgroundColor:c,borderRadius:height/2,transition:'width .5s ease'}}/>
  </div>;
};

/* ‚îÄ‚îÄ Alert Banner ‚îÄ‚îÄ */
const AlertBanner = ({alerts}) => {
  const [cur,setCur] = useState(0);
  useEffect(()=>{const t=setInterval(()=>setCur(i=>(i+1)%alerts.length),5000);return()=>clearInterval(t);},[alerts.length]);
  const a = alerts[cur];
  const bc = a.type==='critical'?C.red:a.type==='warning'?C.yellow:C.blue;
  return <div style={{background:a.type==='critical'?'#7f1d1d':a.type==='warning'?'#78350f':'#1e3a5f',
    borderLeft:`4px solid ${bc}`,borderRadius:8,padding:'12px 16px',display:'flex',alignItems:'center',gap:12,marginBottom:16}}>
    <span style={{fontSize:18}}>{a.type==='critical'?'üö®':a.type==='warning'?'‚ö†Ô∏è':'‚ÑπÔ∏è'}</span>
    <div style={{flex:1}}>
      <span style={{fontSize:11,color:C.t3,textTransform:'uppercase',fontWeight:600}}>{a.area}</span>
      <div style={{fontSize:13,fontWeight:500}}>{a.msg}</div>
    </div>
    <span style={{fontSize:11,color:C.t3,whiteSpace:'nowrap'}}>hace {a.time}</span>
    <div style={{display:'flex',gap:4}}>
      {alerts.map((_,i)=><div key={i} onClick={()=>setCur(i)} style={{width:6,height:6,borderRadius:3,cursor:'pointer',backgroundColor:i===cur?bc:'#334155'}}/>)}
    </div>
  </div>;
};

const KPICard = ({icon,label,value,change,trend}) => (
  <Card style={{textAlign:'center',padding:16}}>
    <div style={{fontSize:12,color:C.t3,marginBottom:4}}>{icon} {label}</div>
    <div style={{fontSize:24,fontWeight:800,color:C.t1}}>{value}</div>
    <div style={{fontSize:12,fontWeight:500,color:trend==='up'?C.green:trend==='down'?C.red:C.t3}}>
      {trend==='up'?'‚ñ≤':trend==='down'?'‚ñº':'‚Üí'} {change}
    </div>
  </Card>
);

const BackBtn = ({onClick}) => {
  const [h,setH]=useState(false);
  return <button onClick={onClick}
    onMouseEnter={()=>setH(true)} onMouseLeave={()=>setH(false)}
    style={{background:'none',border:`1px solid ${h?C.blue:C.border}`,color:h?C.blue:C.t2,
      padding:'6px 14px',borderRadius:8,cursor:'pointer',fontSize:13,fontWeight:500,display:'flex',alignItems:'center',gap:6,transition:'all .2s'}}>
    ‚Üê Volver al Centro de Mando
  </button>;
};

/* ========== COLLAPSIBLE SECTION ========== */
const CollapsibleSection = ({title,icon,defaultOpen=true,children,badge}) => {
  const [isOpen,setIsOpen] = useState(defaultOpen);
  return (
    <Card style={{marginBottom:16,overflow:'hidden',padding:0}}>
      <div onClick={()=>setIsOpen(!isOpen)} style={{
        display:'flex',
        alignItems:'center',
        justifyContent:'space-between',
        padding:'16px 20px',
        cursor:'pointer',
        userSelect:'none',
        borderBottom:isOpen?`1px solid ${C.border}`:'none',
        transition:'all .2s',
        background:isOpen?'transparent':'#0f1419'
      }}>
        <div style={{display:'flex',alignItems:'center',gap:12}}>
          <span style={{fontSize:20}}>{icon}</span>
          <h3 style={{fontSize:16,fontWeight:700,margin:0,color:C.t1}}>{title}</h3>
          {badge && <Badge color={C.blue}>{badge}</Badge>}
        </div>
        <span style={{fontSize:16,transition:'transform .3s',transform:isOpen?'rotate(180deg)':'rotate(0deg)',color:C.t3}}>
          ‚ñº
        </span>
      </div>
      {isOpen && <div style={{padding:20}}>{children}</div>}
    </Card>
  );
};

/* ========== MASTER VIEW ========== */
const AreaCard = ({icon,title,metrics,onClick}) => (
  <Card onClick={onClick} hoverable>
    <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:16}}>
      <div style={{display:'flex',alignItems:'center',gap:8}}>
        <span style={{fontSize:20}}>{icon}</span>
        <h3 style={{fontSize:16,fontWeight:700,color:C.t1}}>{title}</h3>
      </div>
      <span style={{fontSize:18,color:C.t3}}>‚Üí</span>
    </div>
    <div style={{display:'flex',flexDirection:'column',gap:12}}>
      {metrics.map((m,i)=>(
        <div key={i}>
          <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
            <span style={{fontSize:13,color:C.t2}}>{m.label}</span>
            <span style={{fontSize:13,fontWeight:600,color:m.color||C.t1}}>{m.value}</span>
          </div>
          {m.bar && <Bar value={m.barValue} color={m.color} height={6}/>}
        </div>
      ))}
    </div>
  </Card>
);

const MasterView = ({onNav}) => (
  <div className="fade-in">
    <AlertBanner alerts={masterAlerts}/>
    <div style={{display:'grid',gridTemplateColumns:'repeat(5,1fr)',gap:12,marginBottom:24}}>
      {masterKPIs.map((k,i)=><KPICard key={i} {...k}/>)}
    </div>
    <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:16}}>
      <AreaCard icon="‚öôÔ∏è" title="Operaciones" onClick={()=>onNav('ops')} metrics={[
        {label:'Tx Hoy',value:opsData.kpis.txHoy.toLocaleString(),color:C.t1},
        {label:'Tasa √âxito Global',value:opsData.kpis.tasaExitoGlobal+'%',bar:true,barValue:opsData.kpis.tasaExitoGlobal,color:C.green},
        {label:'Latencia Promedio',value:opsData.kpis.latenciaPromedio+'s',color:opsData.kpis.latenciaPromedio<1?C.green:opsData.kpis.latenciaPromedio<2?C.yellow:C.red},
        {label:'Proveedores',value:`${opsData.kpis.proveedoresActivos}/${opsData.kpis.proveedoresTotales} activos`,color:C.green},
        {label:'USD Movilizado hoy',value:'$'+Math.round(opsData.kpis.usdMovilizado/1000)+'K',color:C.t1},
      ]}/>
      <AreaCard icon="üë•" title="Customer Success" onClick={()=>onNav('cs')} metrics={[
        {label:'Contact Rate (meta <15%)',value:csData.atencion.contactRate+'%',color:C.red},
        {label:'Health Score (meta >75)',value:csData.healthScore.promedio,bar:true,barValue:csData.healthScore.promedio,color:C.yellow},
        {label:'Activation Rate (meta >80%)',value:csData.friccion.activationRate+'%',bar:true,barValue:csData.friccion.activationRate,color:C.yellow},
        {label:'NPS Global',value:csData.experiencia.nps,color:C.green},
        {label:'Churn Rate (meta <5%)',value:csData.churnRate+'%',color:C.red},
        {label:'Fricci√≥n Cr√≠tica',value:'KYC 67% üî¥',color:C.red},
      ]}/>
      <AreaCard icon="üè¶" title="Tesorer√≠a" onClick={()=>onNav('treasury')} metrics={[
        {label:'Cobertura de Liquidez',value:`$${(treasuryData.totalLiquidity/1000).toFixed(1)}K`,color:C.green},
        {label:'Posici√≥n EUR‚ÜíVE',value:'#1 mercado',color:C.green},
        {label:'Revenue B2B (Remitee Ene)',value:'$171,955',color:C.green},
        {label:'Rentabilidad ES‚ÜíVE',value:'7.1%',color:C.green},
        {label:'Liquidez cr√≠tica',value:'Brasil üî¥ (84.8%)',color:C.red},
      ]}/>
      <AreaCard icon="üîÑ" title="Conciliaciones" onClick={()=>onNav('recon')} metrics={[
        {label:'Match Rate General',value:'98.8%',bar:true,barValue:98.8,color:C.green},
        {label:'Txns Pendientes',value:'112',color:C.yellow},
        {label:'Discrepancias',value:'37',color:C.red},
        {label:'Peor Ruta',value:'CO‚ÜíVE (98.2%)',color:C.orange},
        {label:'√öltima conciliaci√≥n',value:'Hace 22 min',color:C.t2},
      ]}/>
    </div>
  </div>
);

/* ========== TABLE HELPER ========== */
const Table = ({headers,rows}) => (
  <div style={{overflowX:'auto'}}>
    <table style={{width:'100%',borderCollapse:'collapse',fontSize:13}}>
      <thead><tr style={{borderBottom:`1px solid ${C.border}`}}>
        {headers.map(h=><th key={h} style={{padding:'8px 12px',textAlign:'left',color:C.t3,fontWeight:600,fontSize:11,textTransform:'uppercase'}}>{h}</th>)}
      </tr></thead>
      <tbody>{rows}</tbody>
    </table>
  </div>
);

/* ========== OPERATIONS ========== */
const OpsView = ({onBack}) => (
  <div className="fade-in">
    <div style={{display:'flex',alignItems:'center',gap:16,marginBottom:20}}>
      <BackBtn onClick={onBack}/><h2 style={{fontSize:20,fontWeight:700}}>‚öôÔ∏è Centro de Mando ‚Äî Operaciones</h2>
    </div>

    <CollapsibleSection title="KPI Strip" icon="üìä" defaultOpen={true}>
      <div style={{display:'grid',gridTemplateColumns:'repeat(6,1fr)',gap:12}}>
        {[
          {label:'Tx Hoy',value:opsData.kpis.txHoy.toLocaleString(),color:C.t1},
          {label:'USD Movilizado',value:'$'+Math.round(opsData.kpis.usdMovilizado/1000)+'K',color:C.green},
          {label:'Latencia Promedio',value:opsData.kpis.latenciaPromedio+'s',color:opsData.kpis.latenciaPromedio<1?C.green:opsData.kpis.latenciaPromedio<2?C.yellow:C.red},
          {label:'Tasa √âxito Global',value:opsData.kpis.tasaExitoGlobal+'%',color:C.green},
          {label:'Proveedores Activos',value:`${opsData.kpis.proveedoresActivos}/${opsData.kpis.proveedoresTotales}`,color:C.blue},
          {label:'Acumulado Mes',value:'$'+Math.round(opsData.kpis.acumuladoMes/1000)+'K',color:C.purple},
        ].map((x,i)=>(
          <Card key={i} style={{textAlign:'center'}}>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>{x.label}</div>
            <div style={{fontSize:18,fontWeight:700,color:x.color}}>{x.value}</div>
          </Card>
        ))}
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Motor de Alertas" icon="üö®" defaultOpen={true}>
      <div style={{display:'flex',flexDirection:'column',gap:8}}>
        {opsData.alertas.map((a,i)=>(
          <div key={i} style={{display:'flex',alignItems:'flex-start',gap:12,padding:'12px',borderRadius:8,
            background:a.severidad==='critical'?'#7f1d1d11':a.severidad==='warning'?'#78350f08':'#1e3a5f08',
            borderLeft:`3px solid ${a.severidad==='critical'?C.red:a.severidad==='warning'?C.yellow:C.blue}`}}>
            <Dot status={a.severidad} size={10}/>
            <div style={{flex:1}}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
                <span style={{fontSize:13,fontWeight:600}}>{a.tipo}</span>
                <span style={{fontSize:11,color:C.t3}}>{a.time}</span>
              </div>
              <div style={{fontSize:12,color:C.t2}}>Proveedor: <strong>{a.proveedor}</strong></div>
              <div style={{fontSize:11,color:C.t3,marginBottom:4}}>{a.condicion}</div>
              <div style={{fontSize:11,fontWeight:500,color:C.purple}}>‚Üí {a.accion}</div>
            </div>
          </div>
        ))}
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Dispersi√≥n por Pa√≠s Destino" icon="üåç" defaultOpen={false}>
      {opsData.dispersion.map((d,i)=>(
        <div key={i} style={{marginBottom:20}}>
          <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.t1}}>{d.pais}</h4>
          <Table headers={['Proveedor','Latencia (ms)','Tasa √âxito','SLA','Tx Hoy','Trend','Estado']}
            rows={d.proveedores.map((p,pi)=>(
              <tr key={pi} style={{borderBottom:`1px solid ${C.border}11`}}>
                <td style={{padding:'10px 12px',fontWeight:600}}>{p.nombre}</td>
                <td style={{padding:'10px 12px'}}>{p.latencia}</td>
                <td style={{padding:'10px 12px',color:p.tasaExito>=95?C.green:p.tasaExito>=90?C.yellow:C.red,fontWeight:600}}>{p.tasaExito}%</td>
                <td style={{padding:'10px 12px',color:C.t3}}>{p.sla}%</td>
                <td style={{padding:'10px 12px'}}>{p.txHoy.toLocaleString()}</td>
                <td style={{padding:'10px 12px'}}>{p.trend7d==='up'?'üìà':p.trend7d==='down'?'üìâ':'‚û°Ô∏è'}</td>
                <td style={{padding:'10px 12px'}}><Badge color={p.status==='ok'?C.green:p.status==='warning'?C.yellow:C.red}>{p.status==='ok'?'OK':p.status==='warning'?'ATENCI√ìN':'CR√çTICO'}</Badge></td>
              </tr>
            ))}/>
        </div>
      ))}
    </CollapsibleSection>

    <CollapsibleSection title="Recaudo por Pa√≠s Origen" icon="üè¶" defaultOpen={false}>
      {opsData.recaudo.map((d,i)=>(
        <div key={i} style={{marginBottom:20}}>
          <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.t1}}>{d.pais}</h4>
          <Table headers={['Proveedor','Latencia (ms)','Tasa √âxito','SLA','Tx Hoy','Trend','Estado']}
            rows={d.proveedores.map((p,pi)=>(
              <tr key={pi} style={{borderBottom:`1px solid ${C.border}11`}}>
                <td style={{padding:'10px 12px',fontWeight:600}}>{p.nombre}</td>
                <td style={{padding:'10px 12px'}}>{p.latencia}</td>
                <td style={{padding:'10px 12px',color:p.tasaExito>=95?C.green:p.tasaExito>=90?C.yellow:C.red,fontWeight:600}}>{p.tasaExito}%</td>
                <td style={{padding:'10px 12px',color:C.t3}}>{p.sla}%</td>
                <td style={{padding:'10px 12px'}}>{p.txHoy.toLocaleString()}</td>
                <td style={{padding:'10px 12px'}}>{p.trend7d==='up'?'üìà':p.trend7d==='down'?'üìâ':'‚û°Ô∏è'}</td>
                <td style={{padding:'10px 12px'}}><Badge color={p.status==='ok'?C.green:p.status==='warning'?C.yellow:C.red}>{p.status==='ok'?'OK':p.status==='warning'?'ATENCI√ìN':'CR√çTICO'}</Badge></td>
              </tr>
            ))}/>
        </div>
      ))}
    </CollapsibleSection>

    <CollapsibleSection title="Reintentos vs Mediana" icon="üìä" defaultOpen={false}>
      <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:16}}>
        <div>
          <h4 style={{fontSize:13,fontWeight:700,marginBottom:12,color:C.t2}}>Comparativo Hoy vs Mediana 30d</h4>
          {opsData.reintentos.map((r,i)=>(
            <div key={i} style={{marginBottom:12}}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
                <span style={{fontSize:12,fontWeight:600}}>{r.proveedor}</span>
                <span style={{fontSize:11,fontWeight:700,color:r.status==='critical'?C.red:r.status==='warning'?C.yellow:C.green}}>{r.pct}%</span>
              </div>
              <div style={{display:'flex',gap:2}}>
                <div style={{flex:1}}>
                  <Bar value={Math.min(r.hoy,250)} max={250} color={C.blue} height={6}/>
                  <div style={{fontSize:9,color:C.t3}}>Hoy: {r.hoy}</div>
                </div>
                <div style={{flex:1}}>
                  <Bar value={Math.min(r.mediana30d,250)} max={250} color={C.t3} height={6}/>
                  <div style={{fontSize:9,color:C.t3}}>Mediana: {r.mediana30d}</div>
                </div>
              </div>
            </div>
          ))}
        </div>
        <div>
          <h4 style={{fontSize:13,fontWeight:700,marginBottom:12,color:C.t2}}>Leyenda</h4>
          <div style={{display:'flex',flexDirection:'column',gap:8}}>
            <div style={{display:'flex',alignItems:'center',gap:8,padding:'8px',background:'#1e3a5f08',borderRadius:6}}>
              <Dot status="green" size={10}/>
              <span style={{fontSize:12}}>OK: ‚â§100%</span>
            </div>
            <div style={{display:'flex',alignItems:'center',gap:8,padding:'8px',background:'#78350f08',borderRadius:6}}>
              <Dot status="yellow" size={10}/>
              <span style={{fontSize:12}}>Atenci√≥n: 100-140%</span>
            </div>
            <div style={{display:'flex',alignItems:'center',gap:8,padding:'8px',background:'#7f1d1d11',borderRadius:6}}>
              <Dot status="critical" size={10}/>
              <span style={{fontSize:12}}>Cr√≠tico: >140%</span>
            </div>
          </div>
        </div>
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Volumen Diario" icon="üìà" defaultOpen={false}>
      <SimpleBarChart data={opsData.volumenDiario} bars={[{key:'real',color:C.blue},{key:'mediana',color:C.t3}]} xKey="hora" height={240}/>
    </CollapsibleSection>

    <CollapsibleSection title="Rutas USD" icon="üí∞" defaultOpen={false}>
      <Table headers={['Ruta','USD Actual','USD Mes Ant','Cambio %']}
        rows={opsData.rutasUSD.map((r,i)=>(
          <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
            <td style={{padding:'10px 12px',fontWeight:600}}>{r.ruta}</td>
            <td style={{padding:'10px 12px'}}>${r.usdActual.toLocaleString()}</td>
            <td style={{padding:'10px 12px',color:C.t3}}>${r.usdMesAnt.toLocaleString()}</td>
            <td style={{padding:'10px 12px'}}><span style={{fontWeight:700,color:r.delta>0?C.green:C.red}}>{r.delta>0?'+':''}{r.delta}%</span></td>
          </tr>
        ))}/>
    </CollapsibleSection>

    <CollapsibleSection title="Liquidez / Cupos" icon="üîí" defaultOpen={false}>
      <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:16}}>
        {opsData.cupos.map((c,i)=>(
          <Card key={i} style={{borderLeft:`4px solid ${c.status==='ok'?C.green:c.status==='warning'?C.yellow:C.red}`}}>
            <div style={{marginBottom:12}}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
                <span style={{fontSize:13,fontWeight:700}}>{c.proveedor}</span>
                <Badge color={c.status==='ok'?C.green:c.status==='warning'?C.yellow:C.red}>{c.pctUtilizado}%</Badge>
              </div>
              <Bar value={c.pctUtilizado} color={c.status==='ok'?C.green:c.status==='warning'?C.yellow:C.red} height={8}/>
            </div>
            <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:8,fontSize:11,color:C.t3}}>
              <div>Movilizado: <strong>${(c.movilizado/1000000).toFixed(1)}M</strong></div>
              <div>Cupo Total: <strong>${(c.cupoTotal/1000000).toFixed(1)}M</strong></div>
              <div>Saldo: <strong>${(c.saldo/1000000).toFixed(1)}M</strong></div>
            </div>
          </Card>
        ))}
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="M√©tricas Fase 2+" icon="üéØ" defaultOpen={false}>
      <div style={{display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:12}}>
        {[
          {label:'Health Score',value:opsData.fase2.healthScore,color:C.blue},
          {label:'MTTR',value:opsData.fase2.mttr,color:C.green},
          {label:'Failover Rate',value:opsData.fase2.failoverRate+'%',color:C.yellow},
          {label:'Costo Prom/Tx',value:opsData.fase2.costoPromTx,color:C.purple},
          {label:'Tasa Congelamiento',value:opsData.fase2.tasaCongelamiento+'%',color:C.orange},
          {label:'Churn Corredor',value:opsData.fase2.churnCorredor+'%',color:C.red},
          {label:'Cola Pendientes',value:opsData.fase2.colaPendientes,color:C.blue},
          {label:'Proyecci√≥n Cupo',value:opsData.fase2.proyeccionCupo,color:C.yellow},
        ].map((x,i)=>(
          <Card key={i} style={{textAlign:'center'}}>
            <div style={{fontSize:10,color:C.t3,marginBottom:4}}>{x.label}</div>
            <div style={{fontSize:16,fontWeight:700,color:x.color}}>{x.value}</div>
          </Card>
        ))}
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Criterios de √âxito" icon="‚úì" defaultOpen={false}>
      <Table headers={['Criterio','Baseline','Objetivo','Actual','Status']}
        rows={opsData.criterios.map((c,i)=>(
          <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
            <td style={{padding:'10px 12px',fontWeight:600}}>{c.criterio}</td>
            <td style={{padding:'10px 12px',fontSize:12,color:C.t3}}>{c.baseline}</td>
            <td style={{padding:'10px 12px',fontSize:12,color:C.green,fontWeight:600}}>{c.objetivo}</td>
            <td style={{padding:'10px 12px',fontSize:12}}>{c.actual}</td>
            <td style={{padding:'10px 12px'}}><Badge color={c.status==='ok'?C.green:C.yellow}>{c.status==='ok'?'EN TRACK':'POR MEJORAR'}</Badge></td>
          </tr>
        ))}/>
    </CollapsibleSection>
  </div>
);

/* ========== CUSTOMER SUCCESS ========== */
const CSView = ({onBack}) => (
  <div className="fade-in">
    <div style={{display:'flex',alignItems:'center',gap:16,marginBottom:20}}>
      <BackBtn onClick={onBack}/><h2 style={{fontSize:20,fontWeight:700}}>üë• Centro de Mando ‚Äî Customer Success</h2>
    </div>

    {/* 1. KPIs Principales & Alertas */}
    <CollapsibleSection title="KPIs Principales & Alertas" icon="üìä" defaultOpen={true}>
      <div style={{display:'grid',gridTemplateColumns:'repeat(6,1fr)',gap:12,marginBottom:20}}>
        {[
          {label:'NPS Global',value:csData.experiencia.nps,color:C.green},
          {label:'CSAT (meta >4.0)',value:csData.experiencia.csat+'/5',color:csData.experiencia.csat>=4?C.green:C.yellow},
          {label:'CES',value:csData.experiencia.ces+'%',color:C.green},
          {label:'Contact Rate (meta <15%)',value:csData.atencion.contactRate+'%',color:C.red},
          {label:'Activation Rate (meta >80%)',value:csData.friccion.activationRate+'%',color:C.yellow},
          {label:'Health Score (meta >75)',value:csData.healthScore.promedio,color:csData.healthScore.promedio>=75?C.green:C.yellow},
        ].map((x,i)=>(
          <Card key={i} style={{textAlign:'center',padding:12}}>
            <div style={{fontSize:10,color:C.t3,marginBottom:4}}>{x.label}</div>
            <div style={{fontSize:18,fontWeight:700,color:x.color}}>{x.value}</div>
          </Card>
        ))}
      </div>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>M√©tricas de √âxito CS</h3>
        <Table headers={['M√©trica','Meta','Actual','Status']}
          rows={csData.metricasExito.map((m,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
              <td style={{padding:'10px 12px',fontWeight:600}}>{m.metrica}</td>
              <td style={{padding:'10px 12px',color:C.t3}}>{m.meta}</td>
              <td style={{padding:'10px 12px',fontWeight:600}}>{m.actual}</td>
              <td style={{padding:'10px 12px'}}>
                <Badge color={m.status==='ok'?C.green:m.status==='warning'?C.yellow:C.red}>
                  {m.status==='' ? '‚úì' : m.status==='warning'?'‚ö†Ô∏è':'üî¥'}
                </Badge>
              </td>
            </tr>
          ))}/>
      </Card>

      <Card>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>üö® Alertas Inteligentes</h3>
        {csData.alertas.map((a,i)=>(
          <div key={i} style={{display:'flex',flexDirection:'column',gap:4,padding:'12px',marginBottom:8,borderRadius:8,
            background:a.prioridad==='critical'?'#7f1d1d':a.prioridad==='high'?'#78350f':a.prioridad==='medium'?'#7c2d12':'#1e3a5f',
            borderLeft:`3px solid ${a.prioridad==='critical'?C.red:a.prioridad==='high'?C.orange:a.prioridad==='medium'?C.yellow:C.green}`}}>
            <div style={{display:'flex',justifyContent:'space-between',alignItems:'start'}}>
              <div style={{fontSize:12,fontWeight:600}}>{a.msg}</div>
              <Badge color={a.prioridad==='critical'?C.red:a.prioridad==='high'?C.orange:a.prioridad==='medium'?C.yellow:C.green}>
                {a.prioridad.toUpperCase()}
              </Badge>
            </div>
            <div style={{fontSize:11,color:C.t2}}><strong>Acci√≥n:</strong> {a.accion}</div>
            <div style={{fontSize:10,color:C.t3}}>Owner: {a.owner} | Plazo: {a.plazo}</div>
          </div>
        ))}
      </Card>
    </CollapsibleSection>

    {/* 2. Atenci√≥n al Cliente ‚Äî Tiempo Real */}
    <CollapsibleSection title="Atenci√≥n al Cliente ‚Äî Tiempo Real" icon="üì±" defaultOpen={true}>
      <div style={{display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:12,marginBottom:16}}>
        {[
          {label:'Casos Activos (meta <80)',value:csData.atencion.casosActivos,color:csData.atencion.casosActivos<80?C.green:C.red},
          {label:'Casos/Agente (meta <5)',value:(csData.atencion.casosActivos/5).toFixed(1),color:csData.atencion.casosActivos/5<5?C.green:C.red},
          {label:'FRT (meta <2 min)',value:csData.atencion.frt,color:C.green},
          {label:'Deflection IA (meta >60%)',value:csData.atencion.deflectionRate+'%',color:csData.atencion.deflectionRate>60?C.green:C.yellow},
          {label:'TMO (meta <15 min)',value:csData.atencion.tmo,color:C.green},
          {label:'Fallback Rate (meta <40%)',value:csData.atencion.fallbackRate+'%',color:csData.atencion.fallbackRate<40?C.green:C.yellow},
          {label:'CSAT Live (meta >4.0)',value:csData.atencion.csatLive+'/5',color:csData.atencion.csatLive>4?C.green:C.yellow},
          {label:'Contact Rate (meta <15%)',value:csData.atencion.contactRate+'%',color:C.red},
        ].map((x,i)=>(
          <Card key={i} style={{textAlign:'center',padding:12}}>
            <div style={{fontSize:10,color:C.t3,marginBottom:4}}>{x.label}</div>
            <div style={{fontSize:16,fontWeight:700,color:x.color}}>{x.value}</div>
          </Card>
        ))}
      </div>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:12}}>Contingencias</h3>
        {csData.atencion.contingencias.map((c,i)=>(
          <div key={i} style={{display:'flex',alignItems:'center',gap:12,padding:'10px 12px',marginBottom:8,borderRadius:8,
            background:c.status==='critical'?'#7f1d1d11':c.status==='warning'?'#78350f08':'#1e3a5f08',
            borderLeft:`3px solid ${c.status==='critical'?C.red:c.status==='warning'?C.yellow:C.green}`}}>
            <Dot status={c.status} size={10}/>
            <div style={{flex:1}}>
              <div style={{fontSize:13,fontWeight:500}}>{c.alerta}</div>
              <div style={{fontSize:11,color:C.t3}}>{c.detalle}</div>
            </div>
          </div>
        ))}
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:12}}>Volumen Actual vs Promedio</h3>
        <DualAreaChart data={csData.atencion.volumenHora} keys={['real','promedio']} colors={[C.blue,C.t3]} xKey="hora" height={220}/>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:12}}>Top 5 Motivos de Contacto</h3>
        <Table headers={['Motivo','Casos','%','Trend','Tiempo Prom']}
          rows={csData.atencion.topMotivos.map((m,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
              <td style={{padding:'10px 12px',fontWeight:600}}>{m.motivo}</td>
              <td style={{padding:'10px 12px'}}>{m.casos}</td>
              <td style={{padding:'10px 12px'}}>{m.pct}%</td>
              <td style={{padding:'10px 12px'}}>
                <span style={{color:m.trend==='up'?C.red:m.trend==='down'?C.green:C.yellow}}>
                  {m.trend==='up'?'üìà':m.trend==='down'?'üìâ':'‚û°Ô∏è'} {m.trendPct}%
                </span>
              </td>
              <td style={{padding:'10px 12px'}}>{m.avgTime}</td>
            </tr>
          ))}/>
      </Card>

      <Card>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:12}}>Distribuci√≥n por Canal</h3>
        <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:12}}>
          {[
            {canal:'WhatsApp',pct:csData.atencion.canales.whatsapp},
            {canal:'In-App',pct:csData.atencion.canales.inApp},
            {canal:'Email',pct:csData.atencion.canales.email},
          ].map((c,i)=>(
            <div key={i}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
                <span style={{fontSize:12,fontWeight:600}}>{c.canal}</span>
                <span style={{fontSize:12,fontWeight:700,color:C.blue}}>{c.pct}%</span>
              </div>
              <Bar value={c.pct} color={C.blue} height={8}/>
            </div>
          ))}
        </div>
      </Card>
    </CollapsibleSection>

    {/* 3. Fricci√≥n en Customer Journey */}
    <CollapsibleSection title="Fricci√≥n en Customer Journey" icon="üîÑ" defaultOpen={true}>
      <Card style={{marginBottom:16,padding:16,background:'#1e3a5f'}}>
        <div style={{fontSize:12,color:C.t2,marginBottom:8}}>Formula:</div>
        <div style={{fontSize:13,fontWeight:600,color:C.blue}}>FRICCI√ìN = (Casos de Soporte / Usuarios en Etapa) √ó 100</div>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:16}}>Fricci√≥n por Etapa</h3>
        <div style={{display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:12}}>
          {csData.friccion.etapas.map((e,i)=>(
            <Card key={i} style={{background:C.card,padding:12,borderTop:`4px solid ${e.color}`}}>
              <div style={{fontSize:11,color:C.t3,marginBottom:8,fontWeight:600}}>{e.etapa}</div>
              <div style={{fontSize:24,fontWeight:800,color:e.color,marginBottom:4}}>{e.friccion}%</div>
              <div style={{fontSize:10,color:C.t3,marginBottom:8}}>{e.usuarios.toLocaleString()} usuarios | {e.casosSupport} casos</div>
              <Bar value={e.friccion} max={100} color={e.color} height={4}/>
              <div style={{fontSize:10,color:C.t3,marginTop:8}}>Top: {e.topMotivo}</div>
            </Card>
          ))}
        </div>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Detalle de Fricci√≥n por Etapa</h3>
        <Table headers={['Etapa','Usuarios','Casos Soporte','Fricci√≥n %','Top Motivo','Acci√≥n Requerida']}
          rows={csData.friccion.etapas.map((e,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`,background:e.color===C.red?'#7f1d1d11':''}}>
              <td style={{padding:'10px 12px',fontWeight:600}}>{e.etapa}</td>
              <td style={{padding:'10px 12px'}}>{e.usuarios.toLocaleString()}</td>
              <td style={{padding:'10px 12px'}}>{e.casosSupport}</td>
              <td style={{padding:'10px 12px',fontWeight:700,color:e.color}}>{e.friccion}%</td>
              <td style={{padding:'10px 12px',fontSize:12}}>{e.topMotivo}</td>
              <td style={{padding:'10px 12px',fontSize:11,color:e.color,fontWeight:600}}>{e.accion}</td>
            </tr>
          ))}/>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:12}}>Activation Rate</h3>
        <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:16}}>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Actual (meta >80%)</div>
            <div style={{fontSize:28,fontWeight:800,color:csData.friccion.activationRate>=80?C.green:C.yellow}}>{csData.friccion.activationRate}%</div>
          </div>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Trend 30d</div>
            <div style={{fontSize:18,fontWeight:700,color:C.red}}>{csData.friccion.activationTrend}%</div>
          </div>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Causa Ra√≠z</div>
            <div style={{fontSize:13,fontWeight:600,color:C.orange}}>{csData.friccion.activationCausa}</div>
          </div>
        </div>
      </Card>

      <Card>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:12}}>Time-to-Activate</h3>
        <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:16}}>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Mediana Actual</div>
            <div style={{fontSize:24,fontWeight:800,color:C.blue}}>{csData.friccion.medianaActivacion} d√≠as</div>
          </div>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Meta</div>
            <div style={{fontSize:24,fontWeight:800,color:C.green}}>{csData.friccion.metaActivacion} d√≠as</div>
          </div>
        </div>
      </Card>
    </CollapsibleSection>

    {/* 4. Salud de la Base de Usuarios */}
    <CollapsibleSection title="Salud de la Base de Usuarios" icon="‚ù§Ô∏è" defaultOpen={true}>
      <Card style={{marginBottom:16}}>
        <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:16}}>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Health Score (meta >75)</div>
            <div style={{fontSize:28,fontWeight:800,color:csData.healthScore.promedio<75?C.yellow:C.green}}>{csData.healthScore.promedio}</div>
          </div>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Trend 30d</div>
            <div style={{fontSize:18,fontWeight:700,color:C.green}}>{csData.healthScore.trend30d}</div>
          </div>
          <div>
            <div style={{fontSize:11,color:C.t3,marginBottom:4}}>Meta vs Actual</div>
            <Bar value={(csData.healthScore.promedio/csData.healthScore.meta)*100} max={100} color={C.blue} height={8}/>
          </div>
        </div>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Distribuci√≥n de Health Score</h3>
        <div style={{display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:12}}>
          {csData.healthScore.distribucion.map((d,i)=>(
            <div key={i}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
                <span style={{fontSize:11,fontWeight:600}}>{d.label}</span>
                <span style={{fontSize:11,fontWeight:700,color:d.color}}>{d.pct}%</span>
              </div>
              <Bar value={d.pct} color={d.color} height={8}/>
              <div style={{fontSize:10,color:C.t3,marginTop:4}}>{d.count.toLocaleString()}</div>
            </div>
          ))}
        </div>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Componentes Health Score</h3>
        {csData.healthScore.componentes.map((c,i)=>(
          <div key={i} style={{marginBottom:12}}>
            <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
              <span style={{fontSize:12,fontWeight:600}}>{c.nombre} ({c.peso}%)</span>
              <span style={{fontSize:10,color:C.t3}}>{c.desc}</span>
            </div>
            <Bar value={c.peso} max={25} color={C.purple} height={6}/>
          </div>
        ))}
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Evoluci√≥n Health Score</h3>
        <Table headers={['Mes','Score','% Saludables','% At Risk']}
          rows={csData.healthScore.evolucion.map((e,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
              <td style={{padding:'10px 12px',fontWeight:600}}>{e.mes}</td>
              <td style={{padding:'10px 12px',fontWeight:700,color:C.blue}}>{e.score}</td>
              <td style={{padding:'10px 12px',color:C.green}}>{e.pctSaludables}%</td>
              <td style={{padding:'10px 12px',color:C.red}}>{e.pctRisk}%</td>
            </tr>
          ))}/>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Segmentaci√≥n RFM</h3>
        <Table headers={['Segmento','Count','%','Tx/Mes','LTV','Churn','NPS','Contact Rate','Trend']}
          rows={csData.segments.map((s,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
              <td style={{padding:'10px 12px',fontWeight:600,display:'flex',alignItems:'center',gap:6}}>
                <div style={{width:8,height:8,borderRadius:2,backgroundColor:s.color}}/>
                {s.name}
              </td>
              <td style={{padding:'10px 12px'}}>{s.count.toLocaleString()}</td>
              <td style={{padding:'10px 12px'}}>{s.pct}%</td>
              <td style={{padding:'10px 12px'}}>{s.avgTxMonth}</td>
              <td style={{padding:'10px 12px'}}>${s.ltv.toLocaleString()}</td>
              <td style={{padding:'10px 12px',color:s.churnRate>20?C.red:s.churnRate>10?C.yellow:C.green,fontWeight:600}}>{s.churnRate}%</td>
              <td style={{padding:'10px 12px',fontWeight:600}}>{s.nps}</td>
              <td style={{padding:'10px 12px'}}>{s.contactRate}%</td>
              <td style={{padding:'10px 12px'}}>{s.trend}</td>
            </tr>
          ))}/>
      </Card>

      <Card>
        <h3 style={{fontSize:12,fontWeight:700,marginBottom:8,color:C.orange}}>Insight:</h3>
        <div style={{fontSize:12,color:C.t2}}>Casual Users baj√≥ -3.8% en 30 d√≠as ‚Üí 11,000 usuarios en riesgo (At Risk + Very At Risk). Riesgo de migraci√≥n a segmentos m√°s cr√≠ticos.</div>
      </Card>
    </CollapsibleSection>

    {/* 5. Experiencia del Usuario */}
    <CollapsibleSection title="Experiencia del Usuario" icon="üòä" defaultOpen={false}>
      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>NPS por Segmento</h3>
        <Table headers={['Segmento','NPS','Trend','% Detractores','% Pasivos','% Promotores']}
          rows={csData.experiencia.npsPorSegmento.map((s,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
              <td style={{padding:'10px 12px',fontWeight:600}}>{s.segmento}</td>
              <td style={{padding:'10px 12px',fontWeight:700,color:s.nps>=70?C.green:s.nps>=50?C.yellow:C.red}}>{s.nps}</td>
              <td style={{padding:'10px 12px',color:s.trend.includes('-')?C.red:C.green}}>{s.trend}</td>
              <td style={{padding:'10px 12px',color:C.red}}>{s.detractores}%</td>
              <td style={{padding:'10px 12px',color:C.yellow}}>{s.pasivos}%</td>
              <td style={{padding:'10px 12px',color:C.green}}>{s.promotores}%</td>
            </tr>
          ))}/>
      </Card>

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>NPS por Pa√≠s</h3>
        <Table headers={['Pa√≠s','NPS','CSAT','Casos/1k Usuarios','Top Fricci√≥n']}
          rows={csData.experiencia.npsPorPais.map((p,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`,background:p.pais==='Colombia'?'#7f1d1d11':''}}>
              <td style={{padding:'10px 12px',fontWeight:600,color:p.pais==='Colombia'?C.red:C.t1}}>{p.pais}</td>
              <td style={{padding:'10px 12px',fontWeight:700,color:p.nps>=70?C.green:p.nps>=50?C.yellow:C.red}}>{p.nps}</td>
              <td style={{padding:'10px 12px'}}>{p.csat}/5</td>
              <td style={{padding:'10px 12px'}}>{p.casosPer1k}</td>
              <td style={{padding:'10px 12px',fontSize:11}}>{p.topFriccion}</td>
            </tr>
          ))}/>
      </Card>

      {csData.experiencia.npsPorPais[1].nps < 72 && (
        <Card style={{marginBottom:16,background:'#7f1d1d',borderLeft:`3px solid ${C.red}`}}>
          <div style={{fontSize:12,fontWeight:600,color:C.red}}>‚ö†Ô∏è ALERT: NPS Colombia</div>
          <div style={{fontSize:11,color:C.t2,marginTop:4}}>NPS baj√≥ de 72 a 58 en 2 semanas. Investigar causa ra√≠z inmediatamente.</div>
        </Card>
      )}

      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Retention Curve (M1-M12)</h3>
        <SimpleLineChart data={csData.retencion.curva} dataKey="rate" color={C.blue} height={200} yMin={0} yMax={100}/>
      </Card>

      <Card>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Contact Rate por Segmento</h3>
        <div style={{display:'flex',flexDirection:'column',gap:12}}>
          {csData.experiencia.contactRatePorSegmento.map((c,i)=>(
            <div key={i}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
                <span style={{fontSize:12,fontWeight:600}}>{c.segmento}</span>
                <span style={{fontSize:12,fontWeight:700,color:c.rate>20?C.red:C.green}}>{c.rate}%</span>
              </div>
              <Bar value={c.rate} max={35} color={c.rate>20?C.red:c.rate>15?C.yellow:C.green} height={8}/>
            </div>
          ))}
        </div>
      </Card>
    </CollapsibleSection>

    {/* 6. Retenci√≥n & Estrategias */}
    <CollapsibleSection title="Retenci√≥n & Estrategias" icon="üéØ" defaultOpen={false}>
      <Card style={{marginBottom:16}}>
        <h3 style={{fontSize:13,fontWeight:700,marginBottom:12}}>Estrategias Activas</h3>
        <Table headers={['Estrategia','Segmento','Usuarios','Status','Tasa Reactivaci√≥n','Pr√≥xima Revisi√≥n']}
          rows={csData.retencion.estrategias.map((s,i)=>(
            <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
              <td style={{padding:'10px 12px',fontWeight:600}}>{s.nombre}</td>
              <td style={{padding:'10px 12px'}}>{s.segmento}</td>
              <td style={{padding:'10px 12px'}}>{s.usuarios.toLocaleString()}</td>
              <td style={{padding:'10px 12px'}}>
                <Badge color={s.status==='active'?C.green:C.yellow}>
                  {s.status==='' ? '‚úì' : s.status.toUpperCase()}
                </Badge>
              </td>
              <td style={{padding:'10px 12px',color:C.green,fontWeight:600}}>{s.tasaReactivacion?s.tasaReactivacion+'%':'-'}</td>
              <td style={{padding:'10px 12px',fontSize:11}}>{s.proximaRevision}</td>
            </tr>
          ))}/>
      </Card>

      <Card>
        <div style={{fontSize:12,color:C.t2,padding:12,borderRadius:8,background:'#1e3a5f'}}>
          <strong>CS Process:</strong> CS define estrategia ‚Üí Growth ejecuta ‚Üí CS mide impacto
        </div>
      </Card>
    </CollapsibleSection>
  </div>
);

/* ========== TREASURY ========== */
const TreasuryView = ({onBack}) => (
  <div className="fade-in">
    <div style={{display:'flex',alignItems:'center',gap:16,marginBottom:20}}>
      <BackBtn onClick={onBack}/><h2 style={{fontSize:20,fontWeight:700}}>üè¶ Centro de Mando ‚Äî Tesorer√≠a</h2>
    </div>

    <Card style={{marginBottom:16,borderTop:`3px solid ${C.purple}`}}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:14}}>
        <h3 style={{fontSize:15,fontWeight:700}}>üì° Monitoreo Tiempo Real ‚Äî M√©tricas Cr√≠ticas</h3>
        <Badge color={C.purple}>LIVE</Badge>
      </div>
      <Table headers={['üö¶','M√©trica Tiempo Real','Valor Actual','Accionable que gatilla','KPI Impactado']}
        rows={treasuryData.realtime.map((r,i)=>(
          <tr key={i} style={{borderBottom:`1px solid ${C.border}11`,background:r.status==='critical'?'#7f1d1d11':r.status==='warning'?'#78350f08':'transparent'}}>
            <td style={{padding:'10px 8px',textAlign:'center'}}><Dot status={r.status} size={10}/></td>
            <td style={{padding:'10px 8px',fontWeight:600,fontSize:13}}>{r.metric}</td>
            <td style={{padding:'10px 8px'}}>
              <div><span style={{fontWeight:700,fontSize:14,color:r.status==='critical'?C.red:r.status==='warning'?C.yellow:C.green}}>{r.value}</span></div>
              <div style={{fontSize:10,color:C.t3}}>{r.detail}</div>
            </td>
            <td style={{padding:'10px 8px',fontSize:11,color:C.t2,maxWidth:280}}>{r.action}</td>
            <td style={{padding:'10px 8px'}}><Badge color={r.status==='critical'?C.red:r.status==='warning'?C.yellow:C.green}>{r.kpi}</Badge></td>
          </tr>
        ))}/>
    </Card>

    <div style={{display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:12,marginBottom:16}}>
      {[
        {l:'Cobertura Total',v:`$${(treasuryData.totalLiquidity/1000).toFixed(1)}K`,c:C.green,top:true},
        {l:'Liq. Recaudaci√≥n',v:`$${(treasuryData.liqRecaudacion/1000).toFixed(1)}K`,sub:'40.7%'},
        {l:'Liq. Operativa',v:`$${(treasuryData.liqOperativa/1000).toFixed(1)}K`,sub:'39.5%'},
        {l:'Liq. Tr√°nsito',v:`$${(treasuryData.liqTransito/1000).toFixed(1)}K`,sub:'19.9%'},
      ].map((x,i)=>(
        <Card key={i} style={{textAlign:'center',...(x.top?{borderTop:`3px solid ${x.c}`}:{})}}>
          <div style={{fontSize:11,color:C.t3}}>{x.l}</div>
          <div style={{fontSize:x.top?24:20,fontWeight:x.top?800:700,color:x.c||C.t1}}>{x.v}</div>
          {x.sub && <div style={{fontSize:11,color:C.t3}}>{x.sub}</div>}
        </Card>
      ))}
    </div>

    <CollapsibleSection title="Tipos de Cambio" icon="üí±" defaultOpen={true}>
      <div style={{marginBottom:20}}>
        <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.t2}}>
          Tipos de Cambio Mercado (Base USD) <span style={{fontSize:11,color:C.t3,fontWeight:400}}>‚Äî Ref: Bloomberg</span>
        </h4>
        <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(140px, 1fr))',gap:12}}>
          {treasuryData.tiposCambio.map((tc,i)=>(
            <div key={i} style={{
              padding:'12px',
              borderRadius:8,
              background:'#1e293b',
              border:`1px solid ${tc.moneda==='CLP'?C.yellow:tc.moneda==='BRL'?C.green:tc.moneda==='EUR'?C.purple:tc.moneda==='COP'?C.blue:tc.moneda==='ARS'?'#64748b':tc.moneda==='PEN'?C.orange:tc.moneda==='MXN'?'#ec4899':C.red}44`,
            }}>
              <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:6}}>
                <Badge color={tc.moneda==='CLP'?C.yellow:tc.moneda==='BRL'?C.green:tc.moneda==='EUR'?C.purple:tc.moneda==='COP'?C.blue:tc.moneda==='ARS'?'#64748b':tc.moneda==='PEN'?C.orange:tc.moneda==='MXN'?'#ec4899':C.red}>
                  {tc.moneda}
                </Badge>
                <span style={{fontSize:10,color:tc.trend==='up'?C.green:C.red,fontWeight:600}}>
                  {tc.cambio} {tc.trend==='up'?'‚Üë':'‚Üì'}
                </span>
              </div>
              <div style={{fontSize:11,color:C.t3,marginBottom:2}}>1 USD =</div>
              <div style={{fontSize:18,fontWeight:800,color:C.t1}}>
                {tc.valor.toLocaleString('es-ES',{minimumFractionDigits:2,maximumFractionDigits:2})}
              </div>
            </div>
          ))}
        </div>
      </div>

      <div>
        <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.blue}}>Tipos de Cambio Retorna (Base USD)</h4>
        <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(140px, 1fr))',gap:12}}>
          {treasuryData.tiposCambioRetorna.map((tc,i)=>(
            <div key={i} style={{
              padding:'12px',
              borderRadius:8,
              background:'#1e293b',
              border:`2px solid ${tc.moneda==='CLP'?C.yellow:tc.moneda==='BRL'?C.green:tc.moneda==='EUR'?C.purple:tc.moneda==='COP'?C.blue:tc.moneda==='ARS'?'#64748b':tc.moneda==='PEN'?C.orange:tc.moneda==='MXN'?'#ec4899':C.red}`,
            }}>
              <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:6}}>
                <Badge color={tc.moneda==='CLP'?C.yellow:tc.moneda==='BRL'?C.green:tc.moneda==='EUR'?C.purple:tc.moneda==='COP'?C.blue:tc.moneda==='ARS'?'#64748b':tc.moneda==='PEN'?C.orange:tc.moneda==='MXN'?'#ec4899':C.red}>
                  {tc.moneda}
                </Badge>
                <span style={{fontSize:10,color:C.blue,fontWeight:600}}>
                  Spread: {tc.spread}
                </span>
              </div>
              <div style={{fontSize:11,color:C.t3,marginBottom:2}}>1 USD =</div>
              <div style={{fontSize:18,fontWeight:800,color:C.blue}}>
                {tc.valor.toLocaleString('es-ES',{minimumFractionDigits:2,maximumFractionDigits:2})}
              </div>
            </div>
          ))}
        </div>
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Liquidez" icon="üíß" defaultOpen={true}>
      <div style={{marginBottom:24}}>
        <h4 style={{fontSize:14,fontWeight:700,marginBottom:16,color:C.blue,paddingBottom:8,borderBottom:`2px solid ${C.blue}44`}}>
          2.1 Liquidez FIAT
        </h4>

        <div style={{marginBottom:16}}>
          <h5 style={{fontSize:13,fontWeight:600,marginBottom:12,color:C.t2}}>Liquidez por Pa√≠s</h5>
          <Table headers={['Pa√≠s','üö¶','Saldo USD','L√≠mite USD','Uso %','Proy. 24h','Tendencia','Acci√≥n']}
            rows={treasuryData.liquidity.map((r,i)=>(
              <tr key={i} style={{borderBottom:`1px solid ${C.border}11`,background:r.status==='critical'?'#7f1d1d11':'transparent'}}>
                <td style={{padding:'10px 12px',fontWeight:600}}>{r.country}</td>
                <td style={{padding:'10px 12px'}}><Dot status={r.status} size={10}/></td>
                <td style={{padding:'10px 12px'}}>${r.saldo.toLocaleString()}</td>
                <td style={{padding:'10px 12px',color:C.t3}}>${r.limite.toLocaleString()}</td>
                <td style={{padding:'10px 12px'}}>
                  <div style={{display:'flex',alignItems:'center',gap:8}}>
                    <span style={{fontWeight:600,color:r.uso>80?C.red:r.uso>60?C.yellow:C.green,minWidth:36}}>{r.uso}%</span>
                    <Bar value={r.uso} height={5}/>
                  </div>
                </td>
                <td style={{padding:'10px 12px'}}><span style={{fontWeight:600,color:r.proyeccion24h>90?C.red:r.proyeccion24h>70?C.yellow:C.green}}>{r.proyeccion24h}%</span></td>
                <td style={{padding:'10px 12px',color:C.t2}}>{r.trend}</td>
                <td style={{padding:'10px 12px'}}>{r.status==='critical'?<Badge color={C.red}>URGENTE</Badge>:r.status==='warning'?<Badge color={C.yellow}>REVISAR</Badge>:<Badge color={C.green}>MONITOR</Badge>}</td>
              </tr>
            ))}/>
        </div>

        <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:16}}>
          <div>
            <h5 style={{fontSize:13,fontWeight:600,marginBottom:12,color:C.t2,display:'flex',alignItems:'center',gap:8}}>
              <span>üì•</span> Proveedores Recaudaci√≥n FIAT
            </h5>
            <Table headers={['Proveedor','Moneda','Balance','√ölt.Act.']}
              rows={treasuryData.liquidezPartners.recaudacion.map((p,i)=>(
                <tr key={i} style={{borderBottom:`1px solid ${C.border}11`,background:p.balance<0?'#7f1d1d11':'transparent'}}>
                  <td style={{padding:'6px 8px',fontWeight:600,fontSize:11}}>{p.proveedor}</td>
                  <td style={{padding:'6px 8px'}}>
                    <Badge color={p.moneda==='COP'?C.blue:p.moneda==='EUR'?C.purple:p.moneda==='PEN'?C.orange:p.moneda==='BRL'?C.green:p.moneda==='VES'?C.red:C.yellow}>
                      {p.moneda}
                    </Badge>
                  </td>
                  <td style={{padding:'6px 8px',fontWeight:600,fontSize:11,color:p.balance<0?C.red:C.green}}>
                    {p.balance.toLocaleString('es-ES',{minimumFractionDigits:2,maximumFractionDigits:2})}
                  </td>
                  <td style={{padding:'6px 8px',fontSize:10,color:C.t3}}>{p.ultimaAct}</td>
                </tr>
              ))}/>
          </div>

          <div>
            <h5 style={{fontSize:13,fontWeight:600,marginBottom:12,color:C.t2,display:'flex',alignItems:'center',gap:8}}>
              <span>üì§</span> Proveedores Dispersi√≥n FIAT
            </h5>
            <Table headers={['Proveedor','C√≠a','Moneda','Balance','√ölt.Act.']}
              rows={treasuryData.liquidezPartners.dispersion.map((p,i)=>(
                <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
                  <td style={{padding:'6px 8px',fontWeight:600,fontSize:11}}>{p.proveedor}</td>
                  <td style={{padding:'6px 8px',fontSize:10,color:C.t3}}>{p.compania}</td>
                  <td style={{padding:'6px 8px'}}>
                    <Badge color={p.moneda==='COP'?C.blue:p.moneda==='USD'?C.green:p.moneda==='USDT'?C.yellow:C.red}>
                      {p.moneda}
                    </Badge>
                  </td>
                  <td style={{padding:'6px 8px',fontWeight:600,fontSize:11,color:C.green}}>
                    {p.balance.toLocaleString('es-ES',{minimumFractionDigits:2,maximumFractionDigits:2})}
                  </td>
                  <td style={{padding:'6px 8px',fontSize:10,color:C.t3}}>{p.ultimaAct}</td>
                </tr>
              ))}/>
          </div>
        </div>
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Flujo" icon="üí∏" defaultOpen={false}>
      <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:16}}>
        <div>
          <h5 style={{fontSize:13,fontWeight:600,marginBottom:12,color:C.t2}}>Flujo de Caja por Hora</h5>
          <DualAreaChart data={treasuryData.cashflowHourly} keys={['ingresos','egresos']} colors={[C.green,C.red]} xKey="hour"/>
        </div>
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Rentabilidades por Ruta" icon="üìà" defaultOpen={false}>
      <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:24}}>
        <div>
          <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.blue,paddingBottom:8,borderBottom:`2px solid ${C.blue}44`}}>
            4.1 Rentabilidades Rutas Principales C2C
          </h4>
          <Table headers={['Ruta','Margen','Vol. Transado','Revenue','Part.']}
            rows={treasuryData.rentabilidad.slice(0,5).map((r,i)=>{
              const revenue = (r.margenConfigurado / 100) * r.volumenTransado;
              return (
                <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
                  <td style={{padding:'6px 8px',fontWeight:600,fontSize:12}}>{r.ruta}</td>
                  <td style={{padding:'6px 8px',color:r.margenConfigurado>=5?C.green:C.yellow,fontWeight:600,fontSize:12}}>{r.margenConfigurado}%</td>
                  <td style={{padding:'6px 8px',color:C.t2,fontSize:12}}>
                    ${(r.volumenTransado/1000000).toFixed(1)}M
                  </td>
                  <td style={{padding:'6px 8px',color:C.green,fontWeight:600,fontSize:12}}>
                    ${(revenue/1000).toFixed(1)}K
                  </td>
                  <td style={{padding:'6px 8px',color:C.t2,fontSize:12}}>
                    {r.participacion}%
                  </td>
                </tr>
              );
            })}/>
        </div>

        <div>
          <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.purple,paddingBottom:8,borderBottom:`2px solid ${C.purple}44`}}>
            4.2 Rentabilidades Rutas Secundarias C2C (Muestra)
          </h4>
          <Table headers={['Ruta','Margen','Vol. Transado','Revenue','Part.']}
            rows={treasuryData.rentabilidadSecundarias.slice(0,5).map((r,i)=>{
              const revenue = (r.margenConfigurado / 100) * r.volumenTransado;
              return (
                <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
                  <td style={{padding:'6px 8px',fontWeight:600,fontSize:12}}>{r.ruta}</td>
                  <td style={{padding:'6px 8px',color:r.margenConfigurado>=5?C.green:C.yellow,fontWeight:600,fontSize:12}}>{r.margenConfigurado}%</td>
                  <td style={{padding:'6px 8px',color:C.t2,fontSize:12}}>
                    ${(r.volumenTransado/1000000).toFixed(1)}M
                  </td>
                  <td style={{padding:'6px 8px',color:C.green,fontWeight:600,fontSize:12}}>
                    ${(revenue/1000).toFixed(1)}K
                  </td>
                  <td style={{padding:'6px 8px',color:C.t2,fontSize:12}}>
                    {r.participacion}%
                  </td>
                </tr>
              );
            })}/>
        </div>
      </div>
    </CollapsibleSection>

    <CollapsibleSection title="Seguimiento de Competencia" icon="üéØ" defaultOpen={false}>
      <div style={{marginBottom:20}}>
        <h4 style={{fontSize:14,fontWeight:700,marginBottom:12,color:C.blue,paddingBottom:8,borderBottom:`2px solid ${C.blue}44`}}>
          5.1 Rutas Principales (Muestra)
        </h4>
        <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(250px, 1fr))',gap:16}}>
          {treasuryData.competencia.rutasPrincipales.slice(0,3).map((ruta,idx)=>{
            const getMedal = (pos) => pos===1?'ü•á':pos===2?'ü•à':pos===3?'ü•â':'';
            const bgColor = ruta.posicionRetorna===1?'#10b98115':ruta.posicionRetorna===2?'#94a3b815':'#64748b15';
            const borderColor = ruta.posicionRetorna===1?C.green:ruta.posicionRetorna===2?'#94a3b8':'#64748b';

            return (
              <div key={idx} style={{
                padding:16,
                borderRadius:12,
                border:`2px solid ${borderColor}`,
                background:bgColor
              }}>
                <div style={{
                  background:ruta.posicionRetorna===1?C.green:ruta.posicionRetorna===2?'#94a3b8':'#64748b',
                  color:'#fff',
                  padding:'8px 12px',
                  borderRadius:8,
                  marginBottom:12,
                  textAlign:'center',
                  fontWeight:700,
                  fontSize:14
                }}>
                  Tasas {ruta.ruta}
                </div>
                <div style={{
                  background:'#1e293b',
                  padding:16,
                  borderRadius:10,
                  marginBottom:12,
                  textAlign:'center'
                }}>
                  <div style={{fontSize:12,color:C.t3,marginBottom:4}}>
                    {getMedal(ruta.posicionRetorna)} Retorna en {ruta.posicionRetorna}¬∞ lugar
                  </div>
                  <div style={{
                    fontSize:28,
                    fontWeight:800,
                    color:ruta.posicionRetorna===1?C.green:ruta.posicionRetorna===2?'#94a3b8':'#64748b'
                  }}>
                    {ruta.tasaRetorna}
                  </div>
                </div>
                <div style={{fontSize:11}}>
                  {ruta.ranking.slice(0,4).map((item,i)=>(
                    <div key={i} style={{
                      display:'flex',
                      padding:'6px 8px',
                      alignItems:'center',
                      background:item.destacar?'#fbbf2422':'transparent',
                      borderLeft:item.destacar?`3px solid ${C.yellow}`:'3px solid transparent',
                      borderBottom:i<3?`1px solid ${C.border}11`:'none'
                    }}>
                      <span style={{width:30,fontWeight:600}}>{getMedal(item.pos) || item.pos}</span>
                      <span style={{flex:1,fontWeight:item.destacar?600:400,fontSize:11}}>{item.empresa}</span>
                      <span style={{
                        width:80,
                        textAlign:'right',
                        fontWeight:600,
                        color:item.destacar?C.yellow:C.t2,
                        fontSize:11
                      }}>
                        {item.tasa}
                      </span>
                    </div>
                  ))}
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </CollapsibleSection>
  </div>
);

/* ========== RECONCILIATION ========== */
const ReconView = ({onBack}) => (
  <div className="fade-in">
    <div style={{display:'flex',alignItems:'center',gap:16,marginBottom:20}}>
      <BackBtn onClick={onBack}/><h2 style={{fontSize:20,fontWeight:700}}>üîÑ Centro de Mando ‚Äî Conciliaciones</h2>
    </div>

    {/* ‚îÄ‚îÄ REAL-TIME MONITORING TABLE ‚îÄ‚îÄ */}
    <Card style={{marginBottom:16,borderTop:`3px solid ${C.purple}`}}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:14}}>
        <h3 style={{fontSize:15,fontWeight:700}}>üì° Monitoreo Tiempo Real ‚Äî Conciliaciones</h3>
        <Badge color={C.purple}>LIVE</Badge>
      </div>
      <Table headers={['üö¶','M√©trica Tiempo Real','Valor Actual','Accionable que gatilla','KPI Impactado']}
        rows={reconData.realtime.map((r,i)=>(
          <tr key={i} style={{borderBottom:`1px solid ${C.border}11`,background:r.status==='critical'?'#7f1d1d11':r.status==='warning'?'#78350f08':'transparent'}}>
            <td style={{padding:'10px 8px',textAlign:'center'}}><Dot status={r.status} size={10}/></td>
            <td style={{padding:'10px 8px',fontWeight:600,fontSize:13}}>{r.metric}</td>
            <td style={{padding:'10px 8px'}}>
              <div><span style={{fontWeight:700,fontSize:14,color:r.status==='critical'?C.red:r.status==='warning'?C.yellow:C.green}}>{r.value}</span></div>
              <div style={{fontSize:10,color:C.t3}}>{r.detail}</div>
            </td>
            <td style={{padding:'10px 8px',fontSize:11,color:C.t2,maxWidth:280}}>{r.action}</td>
            <td style={{padding:'10px 8px'}}><Badge color={r.status==='critical'?C.red:r.status==='warning'?C.yellow:C.green}>{r.kpi}</Badge></td>
          </tr>
        ))}/>
    </Card>

    <Card style={{marginBottom:16}}>
      <h3 style={{fontSize:15,fontWeight:700,marginBottom:12}}>üö® Alertas de Conciliaci√≥n</h3>
      {reconData.alerts.map((a,i)=>(
        <div key={i} style={{display:'flex',alignItems:'center',gap:12,padding:'8px 12px',marginBottom:4,borderRadius:6,
          borderLeft:`3px solid ${a.type==='critical'?C.red:a.type==='warning'?C.yellow:C.blue}`,
          background:a.type==='critical'?'#7f1d1d11':'transparent'}}>
          <span>{a.type==='critical'?'üî¥':a.type==='warning'?'üü°':'üü¢'}</span>
          <span style={{flex:1,fontSize:13}}>{a.msg}</span>
          <span style={{fontSize:11,color:C.t3}}>{a.time}</span>
        </div>
      ))}
    </Card>

    <div style={{display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:12,marginBottom:16}}>
      {[
        {l:'Match Rate',v:`${reconData.summary.matchRate}%`,c:C.green,top:true},
        {l:'Conciliadas',v:reconData.summary.matched.toLocaleString(),sub:`de ${reconData.summary.total.toLocaleString()}`},
        {l:'Pendientes',v:reconData.summary.pending,c:C.yellow,top:true},
        {l:'Discrepancias',v:reconData.summary.discrepancy,c:C.red,top:true},
      ].map((x,i)=>(
        <Card key={i} style={{textAlign:'center',...(x.top?{borderTop:`3px solid ${x.c||C.green}`}:{})}}>
          <div style={{fontSize:11,color:C.t3}}>{x.l}</div>
          <div style={{fontSize:x.top?28:24,fontWeight:x.top?800:700,color:x.c||C.t1}}>{x.v}</div>
          {x.sub && <div style={{fontSize:11,color:C.t3}}>{x.sub}</div>}
        </Card>
      ))}
    </div>

    <Card style={{marginBottom:16}}>
      <h3 style={{fontSize:15,fontWeight:700,marginBottom:16}}>üìä Conciliaci√≥n por Proveedor / Pa√≠s</h3>
      <Table headers={['Tipo','Proveedor','Pa√≠s','üö¶','Total','Conciliadas','Pendientes','Discrepancias','Match Rate']}
        rows={reconData.byProvider.map((r,i)=>(
          <tr key={i} style={{borderBottom:`1px solid ${C.border}11`}}>
            <td style={{padding:'10px 12px'}}>
              <Badge color={r.tipo==='Payins'?C.blue:C.purple}>{r.tipo}</Badge>
            </td>
            <td style={{padding:'10px 12px',fontWeight:600}}>{r.proveedor}</td>
            <td style={{padding:'10px 12px'}}>{r.pais}</td>
            <td style={{padding:'10px 12px'}}><Dot status={r.status} size={10}/></td>
            <td style={{padding:'10px 12px'}}>{r.total.toLocaleString()}</td>
            <td style={{padding:'10px 12px',color:C.green}}>{r.matched.toLocaleString()}</td>
            <td style={{padding:'10px 12px',color:C.yellow}}>{r.pending}</td>
            <td style={{padding:'10px 12px',color:r.discrepancy>5?C.red:C.t2}}>{r.discrepancy}</td>
            <td style={{padding:'10px 12px'}}><span style={{fontWeight:700,color:r.rate>=99?C.green:r.rate>=98?C.yellow:C.red}}>{r.rate}%</span></td>
          </tr>
        ))}/>
    </Card>

    <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:16}}>
      <Card>
        <h3 style={{fontSize:15,fontWeight:700,marginBottom:16}}>‚ö†Ô∏è Tipos de Discrepancia</h3>
        {reconData.discrepancyTypes.map((d,i)=>(
          <div key={i} style={{marginBottom:10}}>
            <div style={{display:'flex',justifyContent:'space-between',marginBottom:4}}>
              <span style={{fontSize:13}}>{d.type}</span>
              <span style={{fontSize:13,fontWeight:600}}>{d.count} ({d.pct}%)</span>
            </div>
            <Bar value={d.pct} color={i===0?C.red:i===1?C.orange:C.yellow} height={5}/>
          </div>
        ))}
      </Card>
      <Card>
        <h3 style={{fontSize:15,fontWeight:700,marginBottom:16}}>üìÖ Match Rate √öltimos 7 D√≠as</h3>
        <SimpleLineChart data={reconData.timeline} dataKey="matched" color={C.green} height={200} yMin={96} yMax={100}/>
      </Card>
    </div>
  </div>
);

/* ========== APP ========== */
const App = () => {
  const [view,setView] = useState('master');
  const [time,setTime] = useState(new Date());
  useEffect(()=>{const t=setInterval(()=>setTime(new Date()),1000);return()=>clearInterval(t);},[]);

  const tabs = [
    {id:'master',icon:'üè†',label:'Maestro'},
    {id:'ops',icon:'‚öôÔ∏è',label:'Ops'},
    {id:'cs',icon:'üë•',label:'CS'},
    {id:'treasury',icon:'üè¶',label:'Tesorer√≠a'},
    {id:'recon',icon:'üîÑ',label:'Conciliaci√≥n'},
  ];

  return (
    <div style={{maxWidth:1400,margin:'0 auto',padding:'16px 24px'}}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:20,paddingBottom:16,borderBottom:`1px solid ${C.border}`}}>
        <div style={{display:'flex',alignItems:'center',gap:12}}>
          <span style={{fontSize:28}}>üéØ</span>
          <div>
            <h1 style={{fontSize:22,fontWeight:800,letterSpacing:'-.5px',color:C.t1}}>CENTRO DE CONTROL RETORNA</h1>
            <div style={{fontSize:11,color:C.t3}}>√öltima actualizaci√≥n: {time.toLocaleDateString('es-CO',{day:'numeric',month:'long',year:'numeric'})}, {time.toLocaleTimeString('es-CO')} (COT)</div>
          </div>
        </div>
        <div style={{display:'flex',gap:6}}>
          {tabs.map(t=>(
            <button key={t.id} onClick={()=>setView(t.id)} style={{
              padding:'6px 14px',borderRadius:8,fontSize:12,fontWeight:600,cursor:'pointer',
              border:view===t.id?'none':`1px solid ${C.border}`,
              background:view===t.id?C.blue:'transparent',
              color:view===t.id?'#fff':C.t2,transition:'all .2s',
            }}>{t.icon} {t.label}</button>
          ))}
        </div>
      </div>

      {view==='master' && <MasterView onNav={setView}/>}
      {view==='ops' && <OpsView onBack={()=>setView('master')}/>}
      {view==='cs' && <CSView onBack={()=>setView('master')}/>}
      {view==='treasury' && <TreasuryView onBack={()=>setView('master')}/>}
      {view==='recon' && <ReconView onBack={()=>setView('master')}/>}
    </div>
  );
};

ReactDOM.render(<App/>, document.getElementById('root'));
</script>
</body>
</html>
